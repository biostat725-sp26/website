<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Prof.&nbsp;Sam Berchuck">

<title>Monte Carlo Sampling – BIOSTAT 725 - Spring 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Monte Carlo Sampling</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/biostat725-sp26" title="GitHub organization" class="quarto-navigation-tool px-1" aria-label="GitHub organization"><i class="bi bi-github"></i></a>
    <a href="https://cmgr.oit.duke.edu/containers" title="RStudio Containers" class="quarto-navigation-tool px-1" aria-label="RStudio Containers"><i class="bi bi-code-square"></i></a>
    <a href="https://edstem.org/us/courses/68995/discussion/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-chat-dots-fill"></i></a>
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-check-square-fill"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://canvas.duke.edu/courses/53305">
            Canvas
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.gradescope.com/courses/903622">
            Gradescope
            </a>
          </li>
      </ul>
    </div>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../support.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Support</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../links.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Useful links</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Computing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing-access.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Access</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing-troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Troubleshooting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing-r-resources.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R resources</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Homework</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-00.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 00</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 03</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../hw/hw-05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW 05</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../live-coding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Live-Coding</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#agenda" id="toc-agenda" class="nav-link active" data-scroll-target="#agenda">Agenda</a></li>
  <li><a href="#monte-carlo-sampling" id="toc-monte-carlo-sampling" class="nav-link" data-scroll-target="#monte-carlo-sampling">Monte Carlo Sampling</a>
  <ul class="collapse">
  <li><a href="#simulating-pi-using-monte-carlo" id="toc-simulating-pi-using-monte-carlo" class="nav-link" data-scroll-target="#simulating-pi-using-monte-carlo">Simulating <span class="math inline">\(\pi\)</span> using Monte Carlo</a></li>
  <li><a href="#monte-carlo-sampling-1" id="toc-monte-carlo-sampling-1" class="nav-link" data-scroll-target="#monte-carlo-sampling-1">Monte Carlo sampling</a></li>
  <li><a href="#monte-carlo-estimation-of-the-ratio" id="toc-monte-carlo-estimation-of-the-ratio" class="nav-link" data-scroll-target="#monte-carlo-estimation-of-the-ratio">Monte Carlo estimation of the ratio</a></li>
  <li><a href="#algorithm-for-estimating-pi" id="toc-algorithm-for-estimating-pi" class="nav-link" data-scroll-target="#algorithm-for-estimating-pi">Algorithm for estimating <span class="math inline">\(\pi\)</span></a></li>
  <li><a href="#algorithm-for-estimating-pi-1" id="toc-algorithm-for-estimating-pi-1" class="nav-link" data-scroll-target="#algorithm-for-estimating-pi-1">Algorithm for estimating <span class="math inline">\(\pi\)</span></a></li>
  <li><a href="#how-big-of-a-difference-does-s-make" id="toc-how-big-of-a-difference-does-s-make" class="nav-link" data-scroll-target="#how-big-of-a-difference-does-s-make">How big of a difference does <span class="math inline">\(S\)</span> make</a></li>
  <li><a href="#estimating-pi-with-increasing-s" id="toc-estimating-pi-with-increasing-s" class="nav-link" data-scroll-target="#estimating-pi-with-increasing-s">Estimating <span class="math inline">\(\pi\)</span> with increasing <span class="math inline">\(S\)</span></a></li>
  <li><a href="#error-in-estimating-pi" id="toc-error-in-estimating-pi" class="nav-link" data-scroll-target="#error-in-estimating-pi">Error in estimating <span class="math inline">\(\pi\)</span></a></li>
  <li><a href="#intuition-behing-monte-carlo-sampling" id="toc-intuition-behing-monte-carlo-sampling" class="nav-link" data-scroll-target="#intuition-behing-monte-carlo-sampling">Intuition behing Monte Carlo sampling</a></li>
  <li><a href="#intuition-behing-monte-carlo-sampling-1" id="toc-intuition-behing-monte-carlo-sampling-1" class="nav-link" data-scroll-target="#intuition-behing-monte-carlo-sampling-1">Intuition behing Monte Carlo sampling</a></li>
  </ul></li>
  <li><a href="#bayesian-inference-using-mc-sampling" id="toc-bayesian-inference-using-mc-sampling" class="nav-link" data-scroll-target="#bayesian-inference-using-mc-sampling">Bayesian inference using MC sampling</a>
  <ul class="collapse">
  <li><a href="#a-motivating-example" id="toc-a-motivating-example" class="nav-link" data-scroll-target="#a-motivating-example">A motivating example</a></li>
  <li><a href="#posterior-inference" id="toc-posterior-inference" class="nav-link" data-scroll-target="#posterior-inference">Posterior inference</a></li>
  <li><a href="#likelihood-specification" id="toc-likelihood-specification" class="nav-link" data-scroll-target="#likelihood-specification">Likelihood specification</a></li>
  <li><a href="#prior-specification" id="toc-prior-specification" class="nav-link" data-scroll-target="#prior-specification">Prior specification</a></li>
  <li><a href="#computing-the-marginal-likelihood" id="toc-computing-the-marginal-likelihood" class="nav-link" data-scroll-target="#computing-the-marginal-likelihood">Computing the marginal likelihood</a></li>
  <li><a href="#computing-the-marginal-likelihood-1" id="toc-computing-the-marginal-likelihood-1" class="nav-link" data-scroll-target="#computing-the-marginal-likelihood-1">Computing the marginal likelihood</a></li>
  <li><a href="#we-can-then-compute-the-posterior" id="toc-we-can-then-compute-the-posterior" class="nav-link" data-scroll-target="#we-can-then-compute-the-posterior">We can then compute the posterior</a></li>
  <li><a href="#computing-the-posterior" id="toc-computing-the-posterior" class="nav-link" data-scroll-target="#computing-the-posterior">Computing the posterior</a></li>
  <li><a href="#lets-inspect-the-posterior" id="toc-lets-inspect-the-posterior" class="nav-link" data-scroll-target="#lets-inspect-the-posterior">Let’s inspect the posterior</a></li>
  <li><a href="#lets-inspect-the-posterior-1" id="toc-lets-inspect-the-posterior-1" class="nav-link" data-scroll-target="#lets-inspect-the-posterior-1">Let’s inspect the posterior</a></li>
  <li><a href="#suppose-my-prior-changes" id="toc-suppose-my-prior-changes" class="nav-link" data-scroll-target="#suppose-my-prior-changes">Suppose my prior changes</a></li>
  <li><a href="#summarizing-the-posterior" id="toc-summarizing-the-posterior" class="nav-link" data-scroll-target="#summarizing-the-posterior">Summarizing the posterior</a></li>
  <li><a href="#summarization-can-be-complex" id="toc-summarization-can-be-complex" class="nav-link" data-scroll-target="#summarization-can-be-complex">Summarization can be complex</a></li>
  <li><a href="#summarizing-the-posterior-1" id="toc-summarizing-the-posterior-1" class="nav-link" data-scroll-target="#summarizing-the-posterior-1">Summarizing the posterior</a></li>
  </ul></li>
  <li><a href="#monte-carlo-sampling-2" id="toc-monte-carlo-sampling-2" class="nav-link" data-scroll-target="#monte-carlo-sampling-2">Monte Carlo sampling</a>
  <ul class="collapse">
  <li><a href="#monte-carlo-mc-sampling" id="toc-monte-carlo-mc-sampling" class="nav-link" data-scroll-target="#monte-carlo-mc-sampling">Monte Carlo (MC) sampling</a></li>
  <li><a href="#mc-approximation" id="toc-mc-approximation" class="nav-link" data-scroll-target="#mc-approximation">MC approximation</a></li>
  <li><a href="#mc-approximation-1" id="toc-mc-approximation-1" class="nav-link" data-scroll-target="#mc-approximation-1">MC approximation</a></li>
  <li><a href="#posterior-inference-for-arbitrary-functions" id="toc-posterior-inference-for-arbitrary-functions" class="nav-link" data-scroll-target="#posterior-inference-for-arbitrary-functions">Posterior inference for arbitrary functions</a></li>
  <li><a href="#how-many-samples-to-take" id="toc-how-many-samples-to-take" class="nav-link" data-scroll-target="#how-many-samples-to-take">How many samples to take?</a></li>
  <li><a href="#returning-to-our-posterior" id="toc-returning-to-our-posterior" class="nav-link" data-scroll-target="#returning-to-our-posterior">Returning to our posterior</a></li>
  <li><a href="#assessing-accuracy" id="toc-assessing-accuracy" class="nav-link" data-scroll-target="#assessing-accuracy">Assessing accuracy</a></li>
  <li><a href="#additional-posterior-summaries" id="toc-additional-posterior-summaries" class="nav-link" data-scroll-target="#additional-posterior-summaries">Additional posterior summaries</a></li>
  </ul></li>
  <li><a href="#additional-examples-of-mc-sampling" id="toc-additional-examples-of-mc-sampling" class="nav-link" data-scroll-target="#additional-examples-of-mc-sampling">Additional examples of MC sampling</a>
  <ul class="collapse">
  <li><a href="#poisson-random-variable" id="toc-poisson-random-variable" class="nav-link" data-scroll-target="#poisson-random-variable">Poisson random variable</a></li>
  <li><a href="#sampling-for-any-distribution" id="toc-sampling-for-any-distribution" class="nav-link" data-scroll-target="#sampling-for-any-distribution">Sampling for any distribution</a></li>
  <li><a href="#combination-of-random-variables" id="toc-combination-of-random-variables" class="nav-link" data-scroll-target="#combination-of-random-variables">Combination of random variables</a></li>
  <li><a href="#prepare-for-next-class" id="toc-prepare-for-next-class" class="nav-link" data-scroll-target="#prepare-for-next-class">Prepare for next class</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/biostat725-sp26/website/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div><div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="02-monte-carlo.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Monte Carlo Sampling</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Prof.&nbsp;Sam Berchuck </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Jan 14, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="agenda" class="level1">
<h1>Agenda</h1>
<ul>
<li><p>Monte Carlo (MC) sampling</p></li>
<li><p>Bayesian inference using MC sampling</p></li>
</ul>
</section>
<section id="monte-carlo-sampling" class="level1">
<h1>Monte Carlo Sampling</h1>
<section id="simulating-pi-using-monte-carlo" class="level2">
<h2 class="anchored" data-anchor-id="simulating-pi-using-monte-carlo">Simulating <span class="math inline">\(\pi\)</span> using Monte Carlo</h2>
<p>Suppose we are interested in estimating <span class="math inline">\(\pi\)</span>.</p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>We can formulate <span class="math inline">\(\pi\)</span> as a function of the area of a square and circle.</p></li>
<li><p>Area of a circle: <span class="math inline">\(A_c = \pi r^2\)</span></p></li>
<li><p>Area of a square: <span class="math inline">\(A_s = 4 r^2\)</span></p></li>
<li><p>The ratio of the two areas is: <span class="math inline">\(\frac{A_c}{A_s} = \frac{\pi r^2}{4 r^2} \implies \pi = \frac{4 A_c}{A_s}\)</span></p></li>
</ul>
</div><div class="column" style="width:40%;">
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="288"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<ul>
<li>If we have an estimate for the ratio we can solve for <span class="math inline">\(\pi\)</span>. The challenge becomes estimating this ratio.</li>
</ul>
</section>
<section id="monte-carlo-sampling-1" class="level2">
<h2 class="anchored" data-anchor-id="monte-carlo-sampling-1">Monte Carlo sampling</h2>
<ul>
<li><p>We can take advantage of how quickly a computer can generate pseudo-random numbers.</p></li>
<li><p>There is a class of algorithms called Monte Carlo sampling that exploit randomness to estimate real world scenarios that would otherwise be difficult to explicitly calculate.</p></li>
<li><p>The name comes from the Monte Carlo Casino in Monaco, where the primary developer of the method, mathematician Stanislaw Ulam, was inspired by his uncle’s gambling habits. (This is who Stan was named after!)</p></li>
</ul>
</section>
<section id="monte-carlo-estimation-of-the-ratio" class="level2">
<h2 class="anchored" data-anchor-id="monte-carlo-estimation-of-the-ratio">Monte Carlo estimation of the ratio</h2>
<ul>
<li><p>We can use a Monte Carlo simulation to estimate the area ratio of the circle to the square.</p></li>
<li><p>Imagine you randomly drop grains of sand into the area of the square. By counting the total number of sand grains in the square (all of them since you’re an accurate dropper) to the number of sand grains inside the circle we get this estimate.</p></li>
<li><p>Multiply the estimated ratio by 4 and you get an estimate for <span class="math inline">\(\pi\)</span>.</p></li>
<li><p>The more grains of sand that are used the more accurate your estimate of <span class="math inline">\(\pi\)</span>.</p></li>
</ul>
</section>
<section id="algorithm-for-estimating-pi" class="level2">
<h2 class="anchored" data-anchor-id="algorithm-for-estimating-pi">Algorithm for estimating <span class="math inline">\(\pi\)</span></h2>
<ol type="1">
<li>Generate a random point <span class="math inline">\((x, y)\)</span> inside a square centered at the origin with length 2.</li>
</ol>
<div class="question">
<p>This is equivalent to assuming:</p>
<ul>
<li><p><span class="math inline">\(f_{X,Y}(x,y) = f_X(x)f_Y(y)\)</span></p></li>
<li><p><span class="math inline">\(f_X(x) = Uniform(-1, 1)\)</span>, <span class="math inline">\(f_Y(y) = Uniform(-1, 1)\)</span></p></li>
</ul>
</div>
<p>. . .</p>
<ol start="2" type="1">
<li>Determine whether the point falls inside the unit circle inscribed in the square by checking whether <span class="math inline">\(x^2 + y^2 \leq 1\)</span>.</li>
</ol>
<p>. . .</p>
<ol start="3" type="1">
<li>Repeat steps 1 and 2 for a large number of points (<span class="math inline">\(S\)</span>).</li>
</ol>
</section>
<section id="algorithm-for-estimating-pi-1" class="level2">
<h2 class="anchored" data-anchor-id="algorithm-for-estimating-pi-1">Algorithm for estimating <span class="math inline">\(\pi\)</span></h2>
<ol type="1">
<li><p>Generate a random point <span class="math inline">\((x, y)\)</span> inside a square centered at the origin with length 2.</p></li>
<li><p>Determine whether the point falls inside the unit circle inscribed in the square by checking whether <span class="math inline">\(x^2 + y^2 \leq 1\)</span>.</p></li>
<li><p>Repeat steps 1 and 2 for a large number of points (<span class="math inline">\(S\)</span>).</p></li>
<li><p>Calculate the ratio of the number of points that fell inside the circle to the total number of points generated.</p></li>
</ol>
<p>. . .</p>
<ol start="5" type="1">
<li>Multiply the ratio by 4 to estimate the value of <span class="math inline">\(\pi\)</span>.</li>
</ol>
</section>
<section id="how-big-of-a-difference-does-s-make" class="level2">
<h2 class="anchored" data-anchor-id="how-big-of-a-difference-does-s-make">How big of a difference does <span class="math inline">\(S\)</span> make</h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="240"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-3-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="240"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-3-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="240"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="estimating-pi-with-increasing-s" class="level2">
<h2 class="anchored" data-anchor-id="estimating-pi-with-increasing-s">Estimating <span class="math inline">\(\pi\)</span> with increasing <span class="math inline">\(S\)</span></h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="error-in-estimating-pi" class="level2">
<h2 class="anchored" data-anchor-id="error-in-estimating-pi">Error in estimating <span class="math inline">\(\pi\)</span></h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="intuition-behing-monte-carlo-sampling" class="level2">
<h2 class="anchored" data-anchor-id="intuition-behing-monte-carlo-sampling">Intuition behing Monte Carlo sampling</h2>
<ul>
<li><p>Assume <span class="math inline">\(X \sim Uniform(-1,1)\)</span> and <span class="math inline">\(Y \sim Uniform(-1,1)\)</span>.</p></li>
<li><p>We can write our problem as, <span class="math inline">\(\pi = 4P(X^2 + Y^2 \leq 1)\)</span>.</p></li>
<li><p>How could we do this without Monte Carlo?</p></li>
<li><p>Define, <span class="math inline">\(Z = X^2 + Y^2\)</span>. We could then use change-of-variables to compute the density of <span class="math inline">\(Z\)</span> and then compute <span class="math inline">\(P(Z \leq 1)\)</span>.</p>
<ul>
<li>This is generally difficult!</li>
</ul></li>
</ul>
</section>
<section id="intuition-behing-monte-carlo-sampling-1" class="level2 midi">
<h2 class="midi anchored" data-anchor-id="intuition-behing-monte-carlo-sampling-1">Intuition behing Monte Carlo sampling</h2>
<ul>
<li>Instead, we could write our problem as an expectation and use the law of large numbers,</li>
</ul>
<p><span class="math display">\[P(X^2 + Y^2 \leq 1) = \mathbb{E}_{X,Y}\left[1\left(X^2 + Y^2 \leq 1\right)\right].\]</span></p>
<ul>
<li><p>Recall: <span class="math inline">\(\mathbb{E}_X[1(A)] = \int_A f_X(x)dx = P(X \in A)\)</span>.</p></li>
<li><p>We then have that, <span class="math display">\[\frac{1}{S}\sum_{i = 1}^S 1\left(X_i^2 + Y_i^2 \leq 1\right) \rightarrow \mathbb{E}_{X,Y}\left[1\left(X^2 + Y^2 \leq 1\right)\right],\]</span></p></li>
</ul>
<p>where <span class="math inline">\((X_i,Y_i) \sim f(X,Y)\)</span>.</p>
</section>
</section>
<section id="bayesian-inference-using-mc-sampling" class="level1">
<h1>Bayesian inference using MC sampling</h1>
<ul>
<li><p>Computing a Bayesian posterior</p></li>
<li><p>Posterior inference using MC sampling</p></li>
</ul>
<section id="a-motivating-example" class="level2">
<h2 class="anchored" data-anchor-id="a-motivating-example">A motivating example</h2>
<ul>
<li><p>Suppose we are interested in estimating the prevalence of diabetes in Durham County. We aim to estimate this prevalence by taking a sample of <span class="math inline">\(n\)</span> individuals in Durham County and we record whether or not they have diabetes, <span class="math inline">\(Y_i\)</span>.</p></li>
<li><p>We assume that <span class="math inline">\(Z = \sum_{i=1}^n Y_i \sim Binomial(n, \pi)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>.</p></li>
<li><p>Our goal is to estimate <span class="math inline">\(\pi\)</span> and perform statistical inference (e.g., point estimation, interval estimation, etc.).</p></li>
</ul>
</section>
<section id="posterior-inference" class="level2">
<h2 class="anchored" data-anchor-id="posterior-inference">Posterior inference</h2>
<ul>
<li>In Bayesian statistics, inference is encoded through the posterior distribution,</li>
</ul>
<p><span class="math display">\[\begin{aligned}
f(\pi | Z) &amp;= \frac{f(Z | \pi)f(\pi)}{f(Z)},\\
&amp;= \frac{f(Z | \pi)f(\pi)}{\int f(Z | \pi)f(\pi)d\pi}.
\end{aligned}\]</span></p>
<ul>
<li>All we have to do is specify the likelihood and prior.</li>
</ul>
</section>
<section id="likelihood-specification" class="level2">
<h2 class="anchored" data-anchor-id="likelihood-specification">Likelihood specification</h2>
<p><span class="math inline">\(Z\)</span> is a Binomial distribution with pmf,</p>
<p><span class="math display">\[f(Z | \pi) = P(Z = z) = {n \choose z} \pi^z(1-\pi)^{n-z},\]</span></p>
<p>where <span class="math inline">\(z \in \{0, 1, \ldots, n\}\)</span>.</p>
<ul>
<li><p><span class="math inline">\({n \choose z} = \frac{n!}{z!(n-z)!} = \frac{\Gamma(n+1)}{\Gamma(z+1)\Gamma(n-z+1)}\)</span></p></li>
<li><p><span class="math inline">\(\Gamma(x) = (x-1)!\)</span></p></li>
</ul>
</section>
<section id="prior-specification" class="level2">
<h2 class="anchored" data-anchor-id="prior-specification">Prior specification</h2>
<p>What do we know about <span class="math inline">\(\pi\)</span>?</p>
<ul>
<li><p><span class="math inline">\(\pi\)</span> is continuous.</p></li>
<li><p><span class="math inline">\(\pi \in (0,1)\)</span>.</p></li>
</ul>
<p>We should place a distribution on <span class="math inline">\(\pi\)</span> that permits these properties.</p>
<p>. . .</p>
<p>One option is the Beta distribution, <span class="math inline">\(\pi \sim Beta(\alpha,\beta)\)</span>, <span class="math display">\[f(\pi) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}\pi^{\alpha-1}(1-\pi)^{\beta-1}.\]</span></p>
</section>
<section id="computing-the-marginal-likelihood" class="level2 midi">
<h2 class="midi anchored" data-anchor-id="computing-the-marginal-likelihood">Computing the marginal likelihood</h2>
<p>Under our prior specification, we can compute the marginal likelihood, <span class="math inline">\(f(Z)\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
f(Z) &amp;= \int f(Z | \pi) f(\pi) d\pi\\
&amp;= \int {n \choose z} \pi^z(1-\pi)^{n-z} \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}\pi^{\alpha-1}(1-\pi)^{\beta-1} d\pi\\
&amp;= {n \choose z}\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} \int \underbrace{\pi^{(\alpha + z) - 1}(1-\pi)^{(\beta + n - z) - 1}}_{Beta\text{ }kernel} d\pi
\end{aligned}\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>The part of the pdf/pmf that depends on the variable is called the <strong>kernel</strong>.</p>
<p>Example: The kernel of the Beta pdf is <span class="math inline">\(\pi^{\alpha-1}(1-\pi)^{\beta-1}\)</span></p>
</div>
</div>
</section>
<section id="computing-the-marginal-likelihood-1" class="level2 midi">
<h2 class="midi anchored" data-anchor-id="computing-the-marginal-likelihood-1">Computing the marginal likelihood</h2>
<p>Under our prior specification, we can compute the marginal likelihood, <span class="math inline">\(f(Z)\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
f(Z) &amp;= {n \choose z}\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} \int \pi^{(\alpha + z) - 1}(1-\pi)^{(\beta + n - z) - 1} d\pi\\
&amp;= {n \choose z}\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} \frac{\Gamma(\alpha+\beta + n)}{\Gamma(\alpha + z)\Gamma(\beta + n - z)}.
\end{aligned}\]</span></p>
</section>
<section id="we-can-then-compute-the-posterior" class="level2 midi">
<h2 class="midi anchored" data-anchor-id="we-can-then-compute-the-posterior">We can then compute the posterior</h2>
<p><span class="math display">\[\begin{aligned}
f(\pi | Z) &amp;= \frac{f(Z | \pi) f(\pi)}{f(Z)}\\
&amp;= \frac{{n \choose z} \pi^z(1-\pi)^{n-z} \times \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}\pi^{\alpha-1}(1-\pi)^{\beta-1}}{{n \choose z}\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} \frac{\Gamma(\alpha+\beta) }{\Gamma(\alpha + z)\Gamma(\beta + n - z)}}\\
&amp;=\frac{\Gamma(\alpha+z)\Gamma(\beta+n-z)}{\Gamma(\alpha + \beta + n)}\pi^{(\alpha + z) - 1} (1 - \pi)^{(\beta + n - z) - 1}\\
&amp;=Beta\left(\alpha + z, \beta + n - z\right).
\end{aligned}\]</span></p>
<ul>
<li><p>A prior that is considered <strong>conjugate</strong> yields a posterior with the same distribution.</p></li>
<li><p>The Beta distribution is conjugate for the Bernoulli/Binomial distributions.</p></li>
</ul>
</section>
<section id="computing-the-posterior" class="level2">
<h2 class="anchored" data-anchor-id="computing-the-posterior">Computing the posterior</h2>
<ul>
<li><p>In general, computing the marginal likelihood, <span class="math inline">\(f(Z)\)</span>, is extremely difficulty.</p></li>
<li><p>An easier approach is to use the kernel trick.</p></li>
</ul>
<p><span class="math display">\[\begin{aligned}
f(\pi | Z) &amp;\propto f(Z | \pi) f(\pi)\\
&amp;\propto \pi^z (1-\pi)^{n - z} \pi^{\alpha-1}(1-\pi)^{\beta-1} \\
&amp;= \pi^{\left(\alpha + z\right) - 1} (1-\pi)^{\left(\beta + n - z\right) - 1}\\
&amp;= Beta\left(\alpha + z, \beta + n - z\right).
\end{aligned}\]</span></p>
<ul>
<li>This only works when a conjugate prior is used.</li>
</ul>
</section>
<section id="lets-inspect-the-posterior" class="level2">
<h2 class="anchored" data-anchor-id="lets-inspect-the-posterior">Let’s inspect the posterior</h2>
<ul>
<li><p>Suppose we conducted a simple random sample of 500 individuals in Durham County and 120 responsed that they had diabetes and 380 that they did not.</p></li>
<li><p>The posterior becomes, <span class="math inline">\(Beta\left(\alpha + 120, \beta + 380\right)\)</span>.</p></li>
<li><p>We must choose our prior distribution wisely.</p></li>
<li><p>Note that:</p>
<ul>
<li><p><span class="math inline">\(\mathbb{E}[\pi] = \alpha/(\alpha + \beta)\)</span></p></li>
<li><p><span class="math inline">\(\mathbb{V}(\pi) = (\alpha\beta)/[(\alpha + \beta)^2(\alpha + \beta + 1)]\)</span>.</p></li>
</ul></li>
<li><p>Typically, <span class="math inline">\(\alpha = \beta = 1\)</span>, which corresponds to a uniform prior on <span class="math inline">\(\pi\)</span>.</p></li>
</ul>
</section>
<section id="lets-inspect-the-posterior-1" class="level2">
<h2 class="anchored" data-anchor-id="lets-inspect-the-posterior-1">Let’s inspect the posterior</h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-6-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="suppose-my-prior-changes" class="level2">
<h2 class="anchored" data-anchor-id="suppose-my-prior-changes">Suppose my prior changes</h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-7-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="summarizing-the-posterior" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-the-posterior">Summarizing the posterior</h2>
<p>We now have a posterior distribution. What do we do now?</p>
<p>. . .</p>
<ol type="1">
<li>Posterior means, medians, modes, and variances</li>
</ol>
<p>. . .</p>
<ol start="2" type="1">
<li>Joint, conditional, and marginal probabilities, for example: <span class="math inline">\(P(\pi &lt; c | Z)\)</span></li>
</ol>
<p>. . .</p>
<ol start="3" type="1">
<li><span class="math inline">\(\alpha\)</span>-quantiles: <span class="math inline">\(\{q_{\alpha} : P(\pi &lt; q_{\alpha} | Z) = \alpha\}, \alpha \in (0,1)\)</span></li>
</ol>
<p>. . .</p>
<ol start="4" type="1">
<li><span class="math inline">\(\ldots\)</span></li>
</ol>
<p>. . .</p>
<p>How do we go about computing these summaries?</p>
</section>
<section id="summarization-can-be-complex" class="level2">
<h2 class="anchored" data-anchor-id="summarization-can-be-complex">Summarization can be complex</h2>
<ul>
<li><p>Posteriors are often not available in closed form.</p></li>
<li><p>Even when we have a closed form posterior, it can be difficult to compute summaries of interest.</p></li>
<li><p>For example, consider <span class="math inline">\(P(\pi &lt; c | Z)\)</span>. What are our options to calculate this probability?</p>
<ul>
<li><p>Direct integration (by hand)</p></li>
<li><p>Numerical integration/software packages (e.g., <span class="math inline">\(\texttt{pbeta}\)</span>)</p></li>
</ul></li>
</ul>
<p>These methods work well for standard posterior quantities and distributions.</p>
</section>
<section id="summarizing-the-posterior-1" class="level2">
<h2 class="anchored" data-anchor-id="summarizing-the-posterior-1">Summarizing the posterior</h2>
<p>However, sometimes we will want to summarize other aspects of a posterior distribution.</p>
<ul>
<li><p><span class="math inline">\(P(\pi \in A| Z)\)</span> for some arbitrary set <span class="math inline">\(A\)</span></p></li>
<li><p>Means and standard deviations of some function of <span class="math inline">\(\pi\)</span>, <span class="math inline">\(g\left(\pi\right)\)</span></p></li>
<li><p>The posterior distribution of functions of many parameters:</p>
<ul>
<li><span class="math inline">\(|\pi_1 - \pi_2|\)</span>, <span class="math inline">\(\pi_1/\pi_2\)</span>, <span class="math inline">\(\max\left\{\pi_1,\ldots,\pi_p\right\}\)</span>, <span class="math inline">\(\dots\)</span></li>
</ul></li>
<li><p>Obtaining exact values for these posterior quantities can be difficult or even impossible.</p></li>
</ul>
<p>What are our options?</p>
</section>
</section>
<section id="monte-carlo-sampling-2" class="level1">
<h1>Monte Carlo sampling</h1>
<section id="monte-carlo-mc-sampling" class="level2">
<h2 class="anchored" data-anchor-id="monte-carlo-mc-sampling">Monte Carlo (MC) sampling</h2>
<ul>
<li><p>Integration method based on random sampling</p></li>
<li><p>The general principles and procedures remain relatively constant across a broad class of problems</p></li>
<li><p>Suppose we have <span class="math inline">\(S\)</span> iid samples from our posterior distribution: <span class="math inline">\(\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\stackrel{\text{iid}}{\sim}f\left(\pi|\mathbf{Y}\right)\)</span></p></li>
<li><p>Then the empirical distribution of <span class="math inline">\(\left\{\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\right\}\)</span> would approximate <span class="math inline">\(f\left(\pi|\mathbf{Y}\right)\)</span>, with the approximation improving as <span class="math inline">\(S\)</span> increases</p></li>
<li><p>The empirical distribution of <span class="math inline">\(\left\{\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\right\}\)</span> is known as a MC approximation to <span class="math inline">\(f\left(\pi|\mathbf{Y}\right)\)</span></p></li>
</ul>
</section>
<section id="mc-approximation" class="level2">
<h2 class="anchored" data-anchor-id="mc-approximation">MC approximation</h2>
<p>Let <span class="math inline">\(g\left(\pi\right)\)</span> be (just about) any function of <span class="math inline">\(\pi\)</span>. The law of large numbers says that if,</p>
<p><span class="math display">\[\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\stackrel{\text{iid}}{\sim}f\left(\pi|\mathbf{Y}\right),\]</span> then, <span class="math display">\[\frac{1}{S}\sum_{s=1}^S g\left(\pi^{\left(s\right)}\right)\rightarrow \mathbb{E}\left[g\left(\pi\right)|\mathbf{Y}\right]=\int g\left(\pi\right)f\left(\pi|\mathbf{Y}\right)d\pi,\]</span> as <span class="math inline">\(S\rightarrow \infty\)</span>.</p>
</section>
<section id="mc-approximation-1" class="level2">
<h2 class="anchored" data-anchor-id="mc-approximation-1">MC approximation</h2>
<ul>
<li><p>Implications (as <span class="math inline">\(S\rightarrow \infty\)</span>):</p>
<ul>
<li><p><span class="math inline">\(\overline{\pi}=\frac{1}{S}\sum_{s=1}^S \pi^{\left(s\right)} \rightarrow \mathbb{E}\left[\pi|\mathbf{Y}\right]\)</span></p></li>
<li><p><span class="math inline">\(\frac{1}{S-1}\sum_{s=1}^S \left(\pi^{\left(s\right)}-\overline{\pi}\right)^2 \rightarrow \mathbb{V}\left(\pi|\mathbf{Y}\right)\)</span></p></li>
<li><p><span class="math inline">\(\frac{1}{S}\sum_{s=1}^S 1\left(\pi^{\left(s\right)}\leq \mathbf{c}\right) \rightarrow P\left(\pi\leq \mathbf{c} | \mathbf{Y}\right)\)</span></p></li>
<li><p><span class="math inline">\(\alpha\)</span>-quantile of <span class="math inline">\(\left\{\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\right\}\rightarrow q_{\alpha}\)</span></p></li>
</ul></li>
<li><p>Just about any aspect of the posterior distribution can be approximated arbitrarily exactly with a large enough MC sample</p></li>
</ul>
</section>
<section id="posterior-inference-for-arbitrary-functions" class="level2">
<h2 class="anchored" data-anchor-id="posterior-inference-for-arbitrary-functions">Posterior inference for arbitrary functions</h2>
<p>Interest in the posterior distribution of a function of <span class="math inline">\(\pi\)</span>, <span class="math inline">\(g\left(\pi\right)\)</span></p>
<ul>
<li><p>MC sampling plan:</p>
<ul>
<li><p>Draw <span class="math inline">\(\pi^{\left(1\right)}\)</span> from <span class="math inline">\(f\left(\pi|\mathbf{Y}\right)\)</span>, calculate <span class="math inline">\(g\left(\pi^{\left(1\right)}\right)\)</span></p>
<p><span class="math inline">\(\ldots\)</span></p></li>
<li><p>Draw <span class="math inline">\(\pi^{\left(S\right)}\)</span> from <span class="math inline">\(f\left(\pi|\mathbf{Y}\right)\)</span>, calculate <span class="math inline">\(g\left(\pi^{\left(S\right)}\right)\)</span></p></li>
</ul>
<p><span class="math inline">\(\Rightarrow g\left(\pi^{\left(1\right)}\right),\ldots,g\left(\pi^{\left(S\right)}\right)\stackrel{\text{iid}}{\sim}f\left(g\left(\pi\right)|\mathbf{Y}\right)\)</span></p></li>
<li><p>Therefore, similar quantities can be estimated (posterior mean, variance, quantiles, distribution, etc.)</p></li>
</ul>
</section>
<section id="how-many-samples-to-take" class="level2 small">
<h2 class="small anchored" data-anchor-id="how-many-samples-to-take">How many samples to take?</h2>
<p>We can use a central limit theorem: <span class="math inline">\(\sqrt{S}\left(\overline{\pi}-\mathbb{E}[\pi | \mathbf{Y}]\right)/\sigma \stackrel{d}{\rightarrow} \text{N}\left(0,1\right)\)</span>,</p>
<ul>
<li><p><span class="math inline">\(\overline{\pi}=\frac{1}{S}\sum_{s=1}^S \pi^{\left(s\right)}\)</span></p></li>
<li><p><span class="math inline">\(\sigma^2 = \mathbb{V}\left(\overline{\pi}\right) = \frac{1}{S^2}\sum_{s=1}^S\mathbb{V}\left(\pi^{(s)}\right) = \frac{1}{S}\mathbb{V}\left(\pi | \mathbf{Y}\right)\)</span>.</p></li>
</ul>
<p><span class="math inline">\(\implies \overline{\pi}\approx N\left(\mathbb{E}[\pi | \mathbf{Y}],\sigma^2/S\right)\)</span></p>
<p>MC standard error: <span class="math inline">\(\sqrt{\frac{\widehat{\sigma}^2}{S}}\)</span>, <span class="math inline">\(\widehat{\sigma}^2=\frac{1}{S-1}\sum_{s=1}^S\left(\pi^{\left(s\right)}-\overline{\pi}\right)^2\)</span></p>
<p>Approximate 95% MC confidence interval for the posterior mean: <span class="math inline">\(\overline{\pi} \pm 2\sqrt{\frac{\widehat{\sigma}^2}{S}}\)</span></p>
<ul>
<li><p>Choose <span class="math inline">\(S\)</span> large enough to report the posterior mean with your desired precision</p></li>
<li><p>Reporting MC standard errors for the posterior mean is a good way to indicate that <span class="math inline">\(S\)</span> is large enough</p></li>
</ul>
</section>
<section id="returning-to-our-posterior" class="level2">
<h2 class="anchored" data-anchor-id="returning-to-our-posterior">Returning to our posterior</h2>
<p>Let’s obtain <span class="math inline">\(S = 1,000\)</span> samples from our posterior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pi_samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="dv">1</span> <span class="sc">+</span> <span class="dv">120</span>, <span class="dv">1</span> <span class="sc">+</span> <span class="dv">380</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can compute the posterior mean and variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2404674</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(pi_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0003437017</code></pre>
</div>
</div>
</section>
<section id="assessing-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="assessing-accuracy">Assessing accuracy</h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-align="center" data-layout-ncol="1">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-10-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="additional-posterior-summaries" class="level2">
<h2 class="anchored" data-anchor-id="additional-posterior-summaries">Additional posterior summaries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># median</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(pi_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2402345</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% credible intervals</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(pi_samples, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.2035750 0.2784977 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># evaluating probability</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(pi_samples <span class="sc">&lt;</span> <span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6992</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarizing arbitrary functions of the parameters</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>pi_new <span class="ot">&lt;-</span> pi_samples<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> pi_samples</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(pi_new), <span class="fu">quantile</span>(pi_new, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5%      97.5% 
-0.2264329 -0.2568972 -0.1951383 </code></pre>
</div>
</div>
</section>
</section>
<section id="additional-examples-of-mc-sampling" class="level1">
<h1>Additional examples of MC sampling</h1>
<section id="poisson-random-variable" class="level2">
<h2 class="anchored" data-anchor-id="poisson-random-variable">Poisson random variable</h2>
<p>Suppose that <span class="math inline">\(Y_i \stackrel{iid}{\sim} Poisson(\lambda)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>. Assume the following conjugate prior, <span class="math inline">\(f(\lambda) \sim Gamma(a, b)\)</span>, so that <span class="math inline">\(f(\lambda|\mathbf{Y}) \sim Gamma(a + \sum_{i=1}^nY_i,b+n)\)</span>. We would like to perform inference for the <span class="math inline">\(\lambda\)</span>. We take <span class="math inline">\(S=10,000\)</span> samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">54</span>) <span class="co"># set seed for replicability</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># number of Monte Carlo samples</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># true value of lambda</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># sample size</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># hyperprior</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># hyperprior</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(S, a <span class="sc">+</span> <span class="fu">sum</span>(Y), b <span class="sc">+</span> n) <span class="co"># sample from posterior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">min</th>
<th style="text-align: right;">q1</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">q3</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3.269</td>
<td style="text-align: right;">3.904</td>
<td style="text-align: right;">4.039</td>
<td style="text-align: right;">4.173</td>
<td style="text-align: right;">4.773</td>
<td style="text-align: right;">4.041</td>
<td style="text-align: right;">0.201</td>
</tr>
</tbody>
</table>
</div>
</div>
<!-- ## Binomial random variable -->
<!-- Suppose that $Y_i \stackrel{iid}{\sim} Bernoulli(\pi)$ for $i = 1,\ldots,n$. Assume the following conjugate prior, $f(\pi) \sim Beta(a, b)$, so that $f(\pi|\mathbf{Y}) \sim Beta(a + \sum_{i=1}^nY_i,b+n - \sum_{i=1}^n)$. We would like to perform inference for the $\pi$. We take $S=10,000$ samples. -->
<!-- ```{r} -->
<!-- set.seed(54) # set seed for replicability -->
<!-- S <- 10000 # number of Monte Carlo samples -->
<!-- pi <- 0.35 # true value of lambda -->
<!-- n <- 1000 # sample size -->
<!-- Y <- rbinom(n, size = 1, prob = pi) -->
<!-- a <- 1 # hyperprior -->
<!-- b <- 1 # hyperprior -->
<!-- samples <- rbeta(S, a + sum(Y), b + n - sum(Y)) # sample from posterior -->
<!-- ``` -->
<!-- ```{r, echo=FALSE} -->
<!-- samples <- data.frame(pi = samples) -->
<!-- samples |> -->
<!--   summarise(min = min(pi), q1 = quantile(pi, 0.25),  -->
<!--             median = median(pi), q3 = quantile(pi, 0.75),  -->
<!--             max = max(pi), mean = mean(pi), sd = sd(pi)) |> -->
<!--   kable(digits = 3) -->
<!-- ``` -->
</section>
<section id="sampling-for-any-distribution" class="level2">
<h2 class="anchored" data-anchor-id="sampling-for-any-distribution">Sampling for any distribution</h2>
<p>Monte Carlo sampling does not have to be used solely for posterior inference. Suppose we are interested in computed summaries for <span class="math inline">\(X_i \stackrel{iid}{\sim} N(3, 4)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>. We take <span class="math inline">\(S = 10,000\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(S, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(moments)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.041546</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.0109433</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(samples <span class="sc">&gt;</span> <span class="dv">4</span>) <span class="co"># P(X_i &gt; 4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3087</code></pre>
</div>
</div>
</section>
<section id="combination-of-random-variables" class="level2">
<h2 class="anchored" data-anchor-id="combination-of-random-variables">Combination of random variables</h2>
<p>Suppose <span class="math inline">\(X_i \stackrel{iid}{\sim} N(3, 4)\)</span> and <span class="math inline">\(Y_i \stackrel{iid}{\sim} \chi^2(df=3)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>. <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> are independent. We are interested in summaries of <span class="math inline">\(Z_i = X_i / Y_i\)</span>. We take <span class="math inline">\(S = 10,000\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(S, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(S, <span class="dv">3</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> x <span class="sc">/</span> y</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.961057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.146081</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5456</code></pre>
</div>
</div>
</section>
<section id="prepare-for-next-class" class="level2">
<h2 class="anchored" data-anchor-id="prepare-for-next-class">Prepare for next class</h2>
<ul>
<li><p>Complete <a href="https://biostat725-sp25.netlify.app/hw/hw-00">HW 00</a> which is due before Thursday’s class</p></li>
<li><p>Complete reading to prepare for Thursday’s lecture</p></li>
<li><p>Thursday’s lecture: Markov chain Monte Carlo</p></li>
</ul>


</section>
</section>

</main> <!-- /main -->

<script>
  // htmlwidgets need to know to resize themselves when slides are shown/hidden.
  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
  // slide changes (different for each slide format).
  (function () {
    // dispatch for htmlwidgets
    function fireSlideEnter() {
      const event = window.document.createEvent("Event");
      event.initEvent("slideenter", true, true);
      window.document.dispatchEvent(event);
    }

    function fireSlideChanged(previousSlide, currentSlide) {
      fireSlideEnter();

      // dispatch for shiny
      if (window.jQuery) {
        if (previousSlide) {
          window.jQuery(previousSlide).trigger("hidden");
        }
        if (currentSlide) {
          window.jQuery(currentSlide).trigger("shown");
        }
      }
    }

    // hookup for slidy
    if (window.w3c_slidy) {
      window.w3c_slidy.add_observer(function (slide_num) {
        // slide_num starts at position 1
        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
      });
    }

  })();
</script>

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/biostat725-sp26\.netlify\.app");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2026, Samuel Berchuck</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/biostat725-sp26/website/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This site is built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>