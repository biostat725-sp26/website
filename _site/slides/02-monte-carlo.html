<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Prof.&nbsp;Sam Berchuck">
  <title>BIOSTAT 725 - Spring 2025 – Monte Carlo Sampling</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Monte Carlo Sampling</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Sam Berchuck 
</div>
</div>
</div>

  <p class="date">Jan 14, 2025</p>
</section>
<section id="agenda" class="title-slide slide level1 center">
<h1>Agenda</h1>
<ul>
<li><p>Monte Carlo (MC) sampling</p></li>
<li><p>Bayesian inference using MC sampling</p></li>
</ul>
</section>

<section>
<section id="monte-carlo-sampling" class="title-slide slide level1 center">
<h1>Monte Carlo Sampling</h1>

</section>
<section id="simulating-pi-using-monte-carlo" class="slide level2">
<h2>Simulating <span class="math inline">\(\pi\)</span> using Monte Carlo</h2>
<p>Suppose we are interested in estimating <span class="math inline">\(\pi\)</span>.</p>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>We can formulate <span class="math inline">\(\pi\)</span> as a function of the area of a square and circle.</p></li>
<li><p>Area of a circle: <span class="math inline">\(A_c = \pi r^2\)</span></p></li>
<li><p>Area of a square: <span class="math inline">\(A_s = 4 r^2\)</span></p></li>
<li><p>The ratio of the two areas is: <span class="math inline">\(\frac{A_c}{A_s} = \frac{\pi r^2}{4 r^2} \implies \pi = \frac{4 A_c}{A_s}\)</span></p></li>
</ul>
</div><div class="column" style="width:40%;">
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-2-1.png" class="quarto-figure quarto-figure-center" width="288"></p>
</figure>
</div>
</div>
</div>
</div>
</div></div>
<ul>
<li>If we have an estimate for the ratio we can solve for <span class="math inline">\(\pi\)</span>. The challenge becomes estimating this ratio.</li>
</ul>
</section>
<section id="monte-carlo-sampling-1" class="slide level2">
<h2>Monte Carlo sampling</h2>
<ul>
<li><p>We can take advantage of how quickly a computer can generate pseudo-random numbers.</p></li>
<li><p>There is a class of algorithms called Monte Carlo sampling that exploit randomness to estimate real world scenarios that would otherwise be difficult to explicitly calculate.</p></li>
<li><p>The name comes from the Monte Carlo Casino in Monaco, where the primary developer of the method, mathematician Stanislaw Ulam, was inspired by his uncle’s gambling habits. (This is who Stan was named after!)</p></li>
</ul>
</section>
<section id="monte-carlo-estimation-of-the-ratio" class="slide level2">
<h2>Monte Carlo estimation of the ratio</h2>
<ul>
<li><p>We can use a Monte Carlo simulation to estimate the area ratio of the circle to the square.</p></li>
<li><p>Imagine you randomly drop grains of sand into the area of the square. By counting the total number of sand grains in the square (all of them since you’re an accurate dropper) to the number of sand grains inside the circle we get this estimate.</p></li>
<li><p>Multiply the estimated ratio by 4 and you get an estimate for <span class="math inline">\(\pi\)</span>.</p></li>
<li><p>The more grains of sand that are used the more accurate your estimate of <span class="math inline">\(\pi\)</span>.</p></li>
</ul>
</section>
<section id="algorithm-for-estimating-pi" class="slide level2">
<h2>Algorithm for estimating <span class="math inline">\(\pi\)</span></h2>
<ol type="1">
<li>Generate a random point <span class="math inline">\((x, y)\)</span> inside a square centered at the origin with length 2.</li>
</ol>
<div class="question">
<p>This is equivalent to assuming:</p>
<ul>
<li><p><span class="math inline">\(f_{X,Y}(x,y) = f_X(x)f_Y(y)\)</span></p></li>
<li><p><span class="math inline">\(f_X(x) = Uniform(-1, 1)\)</span>, <span class="math inline">\(f_Y(y) = Uniform(-1, 1)\)</span></p></li>
</ul>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>Determine whether the point falls inside the unit circle inscribed in the square by checking whether <span class="math inline">\(x^2 + y^2 \leq 1\)</span>.</li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li>Repeat steps 1 and 2 for a large number of points (<span class="math inline">\(S\)</span>).</li>
</ol>
</div>
</section>
<section id="algorithm-for-estimating-pi-1" class="slide level2">
<h2>Algorithm for estimating <span class="math inline">\(\pi\)</span></h2>
<ol type="1">
<li><p>Generate a random point <span class="math inline">\((x, y)\)</span> inside a square centered at the origin with length 2.</p></li>
<li><p>Determine whether the point falls inside the unit circle inscribed in the square by checking whether <span class="math inline">\(x^2 + y^2 \leq 1\)</span>.</p></li>
<li><p>Repeat steps 1 and 2 for a large number of points (<span class="math inline">\(S\)</span>).</p></li>
<li><p>Calculate the ratio of the number of points that fell inside the circle to the total number of points generated.</p></li>
</ol>
<div class="fragment">
<ol start="5" type="1">
<li>Multiply the ratio by 4 to estimate the value of <span class="math inline">\(\pi\)</span>.</li>
</ol>
</div>
</section>
<section id="how-big-of-a-difference-does-s-make" class="slide level2">
<h2>How big of a difference does <span class="math inline">\(S\)</span> make</h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="3" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-3-1.png" class="quarto-figure quarto-figure-center" width="240"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-3-2.png" class="quarto-figure quarto-figure-center" width="240"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-3-3.png" class="quarto-figure quarto-figure-center" width="240"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="estimating-pi-with-increasing-s" class="slide level2">
<h2>Estimating <span class="math inline">\(\pi\)</span> with increasing <span class="math inline">\(S\)</span></h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="error-in-estimating-pi" class="slide level2">
<h2>Error in estimating <span class="math inline">\(\pi\)</span></h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-5-1.png" class="quarto-figure quarto-figure-center" width="768"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="intuition-behing-monte-carlo-sampling" class="slide level2">
<h2>Intuition behing Monte Carlo sampling</h2>
<ul>
<li><p>Assume <span class="math inline">\(X \sim Uniform(-1,1)\)</span> and <span class="math inline">\(Y \sim Uniform(-1,1)\)</span>.</p></li>
<li><p>We can write our problem as, <span class="math inline">\(\pi = 4P(X^2 + Y^2 \leq 1)\)</span>.</p></li>
<li><p>How could we do this without Monte Carlo?</p></li>
<li><p>Define, <span class="math inline">\(Z = X^2 + Y^2\)</span>. We could then use change-of-variables to compute the density of <span class="math inline">\(Z\)</span> and then compute <span class="math inline">\(P(Z \leq 1)\)</span>.</p>
<ul>
<li>This is generally difficult!</li>
</ul></li>
</ul>
</section>
<section id="intuition-behing-monte-carlo-sampling-1" class="slide level2 midi">
<h2>Intuition behing Monte Carlo sampling</h2>
<ul>
<li>Instead, we could write our problem as an expectation and use the law of large numbers,</li>
</ul>
<p><span class="math display">\[P(X^2 + Y^2 \leq 1) = \mathbb{E}_{X,Y}\left[1\left(X^2 + Y^2 \leq 1\right)\right].\]</span></p>
<ul>
<li><p>Recall: <span class="math inline">\(\mathbb{E}_X[1(A)] = \int_A f_X(x)dx = P(X \in A)\)</span>.</p></li>
<li><p>We then have that, <span class="math display">\[\frac{1}{S}\sum_{i = 1}^S 1\left(X_i^2 + Y_i^2 \leq 1\right) \rightarrow \mathbb{E}_{X,Y}\left[1\left(X^2 + Y^2 \leq 1\right)\right],\]</span></p></li>
</ul>
<p>where <span class="math inline">\((X_i,Y_i) \sim f(X,Y)\)</span>.</p>
</section></section>
<section>
<section id="bayesian-inference-using-mc-sampling" class="title-slide slide level1 center">
<h1>Bayesian inference using MC sampling</h1>
<ul>
<li><p>Computing a Bayesian posterior</p></li>
<li><p>Posterior inference using MC sampling</p></li>
</ul>
</section>
<section id="a-motivating-example" class="slide level2">
<h2>A motivating example</h2>
<ul>
<li><p>Suppose we are interested in estimating the prevalence of diabetes in Durham County. We aim to estimate this prevalence by taking a sample of <span class="math inline">\(n\)</span> individuals in Durham County and we record whether or not they have diabetes, <span class="math inline">\(Y_i\)</span>.</p></li>
<li><p>We assume that <span class="math inline">\(Z = \sum_{i=1}^n Y_i \sim Binomial(n, \pi)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>.</p></li>
<li><p>Our goal is to estimate <span class="math inline">\(\pi\)</span> and perform statistical inference (e.g., point estimation, interval estimation, etc.).</p></li>
</ul>
</section>
<section id="posterior-inference" class="slide level2">
<h2>Posterior inference</h2>
<ul>
<li>In Bayesian statistics, inference is encoded through the posterior distribution,</li>
</ul>
<p><span class="math display">\[\begin{aligned}
f(\pi | Z) &amp;= \frac{f(Z | \pi)f(\pi)}{f(Z)},\\
&amp;= \frac{f(Z | \pi)f(\pi)}{\int f(Z | \pi)f(\pi)d\pi}.
\end{aligned}\]</span></p>
<ul>
<li>All we have to do is specify the likelihood and prior.</li>
</ul>
</section>
<section id="likelihood-specification" class="slide level2">
<h2>Likelihood specification</h2>
<p><span class="math inline">\(Z\)</span> is a Binomial distribution with pmf,</p>
<p><span class="math display">\[f(Z | \pi) = P(Z = z) = {n \choose z} \pi^z(1-\pi)^{n-z},\]</span></p>
<p>where <span class="math inline">\(z \in \{0, 1, \ldots, n\}\)</span>.</p>
<ul>
<li><p><span class="math inline">\({n \choose z} = \frac{n!}{z!(n-z)!} = \frac{\Gamma(n+1)}{\Gamma(z+1)\Gamma(n-z+1)}\)</span></p></li>
<li><p><span class="math inline">\(\Gamma(x) = (x-1)!\)</span></p></li>
</ul>
</section>
<section id="prior-specification" class="slide level2">
<h2>Prior specification</h2>
<p>What do we know about <span class="math inline">\(\pi\)</span>?</p>
<ul>
<li><p><span class="math inline">\(\pi\)</span> is continuous.</p></li>
<li><p><span class="math inline">\(\pi \in (0,1)\)</span>.</p></li>
</ul>
<p>We should place a distribution on <span class="math inline">\(\pi\)</span> that permits these properties.</p>
<div class="fragment">
<p>One option is the Beta distribution, <span class="math inline">\(\pi \sim Beta(\alpha,\beta)\)</span>, <span class="math display">\[f(\pi) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}\pi^{\alpha-1}(1-\pi)^{\beta-1}.\]</span></p>
</div>
</section>
<section id="computing-the-marginal-likelihood" class="slide level2 midi">
<h2>Computing the marginal likelihood</h2>
<p>Under our prior specification, we can compute the marginal likelihood, <span class="math inline">\(f(Z)\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
f(Z) &amp;= \int f(Z | \pi) f(\pi) d\pi\\
&amp;= \int {n \choose z} \pi^z(1-\pi)^{n-z} \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}\pi^{\alpha-1}(1-\pi)^{\beta-1} d\pi\\
&amp;= {n \choose z}\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} \int \underbrace{\pi^{(\alpha + z) - 1}(1-\pi)^{(\beta + n - z) - 1}}_{Beta\text{ }kernel} d\pi
\end{aligned}\]</span></p>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Definition</strong></p>
</div>
<div class="callout-content">
<p>The part of the pdf/pmf that depends on the variable is called the <strong>kernel</strong>.</p>
<p>Example: The kernel of the Beta pdf is <span class="math inline">\(\pi^{\alpha-1}(1-\pi)^{\beta-1}\)</span></p>
</div>
</div>
</div>
</section>
<section id="computing-the-marginal-likelihood-1" class="slide level2 midi">
<h2>Computing the marginal likelihood</h2>
<p>Under our prior specification, we can compute the marginal likelihood, <span class="math inline">\(f(Z)\)</span>:</p>
<p><span class="math display">\[\begin{aligned}
f(Z) &amp;= {n \choose z}\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} \int \pi^{(\alpha + z) - 1}(1-\pi)^{(\beta + n - z) - 1} d\pi\\
&amp;= {n \choose z}\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} \frac{\Gamma(\alpha+\beta + n)}{\Gamma(\alpha + z)\Gamma(\beta + n - z)}.
\end{aligned}\]</span></p>
</section>
<section id="we-can-then-compute-the-posterior" class="slide level2 midi">
<h2>We can then compute the posterior</h2>
<p><span class="math display">\[\begin{aligned}
f(\pi | Z) &amp;= \frac{f(Z | \pi) f(\pi)}{f(Z)}\\
&amp;= \frac{{n \choose z} \pi^z(1-\pi)^{n-z} \times \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)}\pi^{\alpha-1}(1-\pi)^{\beta-1}}{{n \choose z}\frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha+\beta)} \frac{\Gamma(\alpha+\beta) }{\Gamma(\alpha + z)\Gamma(\beta + n - z)}}\\
&amp;=\frac{\Gamma(\alpha+z)\Gamma(\beta+n-z)}{\Gamma(\alpha + \beta + n)}\pi^{(\alpha + z) - 1} (1 - \pi)^{(\beta + n - z) - 1}\\
&amp;=Beta\left(\alpha + z, \beta + n - z\right).
\end{aligned}\]</span></p>
<ul>
<li><p>A prior that is considered <strong>conjugate</strong> yields a posterior with the same distribution.</p></li>
<li><p>The Beta distribution is conjugate for the Bernoulli/Binomial distributions.</p></li>
</ul>
</section>
<section id="computing-the-posterior" class="slide level2">
<h2>Computing the posterior</h2>
<ul>
<li><p>In general, computing the marginal likelihood, <span class="math inline">\(f(Z)\)</span>, is extremely difficulty.</p></li>
<li><p>An easier approach is to use the kernel trick.</p></li>
</ul>
<p><span class="math display">\[\begin{aligned}
f(\pi | Z) &amp;\propto f(Z | \pi) f(\pi)\\
&amp;\propto \pi^z (1-\pi)^{n - z} \pi^{\alpha-1}(1-\pi)^{\beta-1} \\
&amp;= \pi^{\left(\alpha + z\right) - 1} (1-\pi)^{\left(\beta + n - z\right) - 1}\\
&amp;= Beta\left(\alpha + z, \beta + n - z\right).
\end{aligned}\]</span></p>
<ul>
<li>This only works when a conjugate prior is used.</li>
</ul>
</section>
<section id="lets-inspect-the-posterior" class="slide level2">
<h2>Let’s inspect the posterior</h2>
<ul>
<li><p>Suppose we conducted a simple random sample of 500 individuals in Durham County and 120 responsed that they had diabetes and 380 that they did not.</p></li>
<li><p>The posterior becomes, <span class="math inline">\(Beta\left(\alpha + 120, \beta + 380\right)\)</span>.</p></li>
<li><p>We must choose our prior distribution wisely.</p></li>
<li><p>Note that:</p>
<ul>
<li><p><span class="math inline">\(\mathbb{E}[\pi] = \alpha/(\alpha + \beta)\)</span></p></li>
<li><p><span class="math inline">\(\mathbb{V}(\pi) = (\alpha\beta)/[(\alpha + \beta)^2(\alpha + \beta + 1)]\)</span>.</p></li>
</ul></li>
<li><p>Typically, <span class="math inline">\(\alpha = \beta = 1\)</span>, which corresponds to a uniform prior on <span class="math inline">\(\pi\)</span>.</p></li>
</ul>
</section>
<section id="lets-inspect-the-posterior-1" class="slide level2">
<h2>Let’s inspect the posterior</h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-6-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="suppose-my-prior-changes" class="slide level2">
<h2>Suppose my prior changes</h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="2" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-7-1.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-7-2.png" class="quarto-figure quarto-figure-center" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="summarizing-the-posterior" class="slide level2">
<h2>Summarizing the posterior</h2>
<p>We now have a posterior distribution. What do we do now?</p>
<div class="fragment">
<ol type="1">
<li>Posterior means, medians, modes, and variances</li>
</ol>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>Joint, conditional, and marginal probabilities, for example: <span class="math inline">\(P(\pi &lt; c | Z)\)</span></li>
</ol>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><span class="math inline">\(\alpha\)</span>-quantiles: <span class="math inline">\(\{q_{\alpha} : P(\pi &lt; q_{\alpha} | Z) = \alpha\}, \alpha \in (0,1)\)</span></li>
</ol>
</div>
<div class="fragment">
<ol start="4" type="1">
<li><span class="math inline">\(\ldots\)</span></li>
</ol>
</div>
<div class="fragment">
<p>How do we go about computing these summaries?</p>
</div>
</section>
<section id="summarization-can-be-complex" class="slide level2">
<h2>Summarization can be complex</h2>
<ul>
<li><p>Posteriors are often not available in closed form.</p></li>
<li><p>Even when we have a closed form posterior, it can be difficult to compute summaries of interest.</p></li>
<li><p>For example, consider <span class="math inline">\(P(\pi &lt; c | Z)\)</span>. What are our options to calculate this probability?</p>
<ul>
<li><p>Direct integration (by hand)</p></li>
<li><p>Numerical integration/software packages (e.g., <span class="math inline">\(\texttt{pbeta}\)</span>)</p></li>
</ul></li>
</ul>
<p>These methods work well for standard posterior quantities and distributions.</p>
</section>
<section id="summarizing-the-posterior-1" class="slide level2">
<h2>Summarizing the posterior</h2>
<p>However, sometimes we will want to summarize other aspects of a posterior distribution.</p>
<ul>
<li><p><span class="math inline">\(P(\pi \in A| Z)\)</span> for some arbitrary set <span class="math inline">\(A\)</span></p></li>
<li><p>Means and standard deviations of some function of <span class="math inline">\(\pi\)</span>, <span class="math inline">\(g\left(\pi\right)\)</span></p></li>
<li><p>The posterior distribution of functions of many parameters:</p>
<ul>
<li><span class="math inline">\(|\pi_1 - \pi_2|\)</span>, <span class="math inline">\(\pi_1/\pi_2\)</span>, <span class="math inline">\(\max\left\{\pi_1,\ldots,\pi_p\right\}\)</span>, <span class="math inline">\(\dots\)</span></li>
</ul></li>
<li><p>Obtaining exact values for these posterior quantities can be difficult or even impossible.</p></li>
</ul>
<p>What are our options?</p>
</section></section>
<section>
<section id="monte-carlo-sampling-2" class="title-slide slide level1 center">
<h1>Monte Carlo sampling</h1>

</section>
<section id="monte-carlo-mc-sampling" class="slide level2">
<h2>Monte Carlo (MC) sampling</h2>
<ul>
<li><p>Integration method based on random sampling</p></li>
<li><p>The general principles and procedures remain relatively constant across a broad class of problems</p></li>
<li><p>Suppose we have <span class="math inline">\(S\)</span> iid samples from our posterior distribution: <span class="math inline">\(\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\stackrel{\text{iid}}{\sim}f\left(\pi|\mathbf{Y}\right)\)</span></p></li>
<li><p>Then the empirical distribution of <span class="math inline">\(\left\{\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\right\}\)</span> would approximate <span class="math inline">\(f\left(\pi|\mathbf{Y}\right)\)</span>, with the approximation improving as <span class="math inline">\(S\)</span> increases</p></li>
<li><p>The empirical distribution of <span class="math inline">\(\left\{\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\right\}\)</span> is known as a MC approximation to <span class="math inline">\(f\left(\pi|\mathbf{Y}\right)\)</span></p></li>
</ul>
</section>
<section id="mc-approximation" class="slide level2">
<h2>MC approximation</h2>
<p>Let <span class="math inline">\(g\left(\pi\right)\)</span> be (just about) any function of <span class="math inline">\(\pi\)</span>. The law of large numbers says that if,</p>
<p><span class="math display">\[\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\stackrel{\text{iid}}{\sim}f\left(\pi|\mathbf{Y}\right),\]</span> then, <span class="math display">\[\frac{1}{S}\sum_{s=1}^S g\left(\pi^{\left(s\right)}\right)\rightarrow \mathbb{E}\left[g\left(\pi\right)|\mathbf{Y}\right]=\int g\left(\pi\right)f\left(\pi|\mathbf{Y}\right)d\pi,\]</span> as <span class="math inline">\(S\rightarrow \infty\)</span>.</p>
</section>
<section id="mc-approximation-1" class="slide level2">
<h2>MC approximation</h2>
<ul>
<li><p>Implications (as <span class="math inline">\(S\rightarrow \infty\)</span>):</p>
<ul>
<li><p><span class="math inline">\(\overline{\pi}=\frac{1}{S}\sum_{s=1}^S \pi^{\left(s\right)} \rightarrow \mathbb{E}\left[\pi|\mathbf{Y}\right]\)</span></p></li>
<li><p><span class="math inline">\(\frac{1}{S-1}\sum_{s=1}^S \left(\pi^{\left(s\right)}-\overline{\pi}\right)^2 \rightarrow \mathbb{V}\left(\pi|\mathbf{Y}\right)\)</span></p></li>
<li><p><span class="math inline">\(\frac{1}{S}\sum_{s=1}^S 1\left(\pi^{\left(s\right)}\leq \mathbf{c}\right) \rightarrow P\left(\pi\leq \mathbf{c} | \mathbf{Y}\right)\)</span></p></li>
<li><p><span class="math inline">\(\alpha\)</span>-quantile of <span class="math inline">\(\left\{\pi^{\left(1\right)},\ldots,\pi^{\left(S\right)}\right\}\rightarrow q_{\alpha}\)</span></p></li>
</ul></li>
<li><p>Just about any aspect of the posterior distribution can be approximated arbitrarily exactly with a large enough MC sample</p></li>
</ul>
</section>
<section id="posterior-inference-for-arbitrary-functions" class="slide level2">
<h2>Posterior inference for arbitrary functions</h2>
<p>Interest in the posterior distribution of a function of <span class="math inline">\(\pi\)</span>, <span class="math inline">\(g\left(\pi\right)\)</span></p>
<ul>
<li><p>MC sampling plan:</p>
<ul>
<li><p>Draw <span class="math inline">\(\pi^{\left(1\right)}\)</span> from <span class="math inline">\(f\left(\pi|\mathbf{Y}\right)\)</span>, calculate <span class="math inline">\(g\left(\pi^{\left(1\right)}\right)\)</span></p>
<p><span class="math inline">\(\ldots\)</span></p></li>
<li><p>Draw <span class="math inline">\(\pi^{\left(S\right)}\)</span> from <span class="math inline">\(f\left(\pi|\mathbf{Y}\right)\)</span>, calculate <span class="math inline">\(g\left(\pi^{\left(S\right)}\right)\)</span></p></li>
</ul>
<p><span class="math inline">\(\Rightarrow g\left(\pi^{\left(1\right)}\right),\ldots,g\left(\pi^{\left(S\right)}\right)\stackrel{\text{iid}}{\sim}f\left(g\left(\pi\right)|\mathbf{Y}\right)\)</span></p></li>
<li><p>Therefore, similar quantities can be estimated (posterior mean, variance, quantiles, distribution, etc.)</p></li>
</ul>
</section>
<section id="how-many-samples-to-take" class="slide level2 small">
<h2>How many samples to take?</h2>
<p>We can use a central limit theorem: <span class="math inline">\(\sqrt{S}\left(\overline{\pi}-\mathbb{E}[\pi | \mathbf{Y}]\right)/\sigma \stackrel{d}{\rightarrow} \text{N}\left(0,1\right)\)</span>,</p>
<ul>
<li><p><span class="math inline">\(\overline{\pi}=\frac{1}{S}\sum_{s=1}^S \pi^{\left(s\right)}\)</span></p></li>
<li><p><span class="math inline">\(\sigma^2 = \mathbb{V}\left(\overline{\pi}\right) = \frac{1}{S^2}\sum_{s=1}^S\mathbb{V}\left(\pi^{(s)}\right) = \frac{1}{S}\mathbb{V}\left(\pi | \mathbf{Y}\right)\)</span>.</p></li>
</ul>
<p><span class="math inline">\(\implies \overline{\pi}\approx N\left(\mathbb{E}[\pi | \mathbf{Y}],\sigma^2/S\right)\)</span></p>
<p>MC standard error: <span class="math inline">\(\sqrt{\frac{\widehat{\sigma}^2}{S}}\)</span>, <span class="math inline">\(\widehat{\sigma}^2=\frac{1}{S-1}\sum_{s=1}^S\left(\pi^{\left(s\right)}-\overline{\pi}\right)^2\)</span></p>
<p>Approximate 95% MC confidence interval for the posterior mean: <span class="math inline">\(\overline{\pi} \pm 2\sqrt{\frac{\widehat{\sigma}^2}{S}}\)</span></p>
<ul>
<li><p>Choose <span class="math inline">\(S\)</span> large enough to report the posterior mean with your desired precision</p></li>
<li><p>Reporting MC standard errors for the posterior mean is a good way to indicate that <span class="math inline">\(S\)</span> is large enough</p></li>
</ul>
</section>
<section id="returning-to-our-posterior" class="slide level2">
<h2>Returning to our posterior</h2>
<p>Let’s obtain <span class="math inline">\(S = 1,000\)</span> samples from our posterior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>pi_samples <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="dv">1</span> <span class="sc">+</span> <span class="dv">120</span>, <span class="dv">1</span> <span class="sc">+</span> <span class="dv">380</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can compute the posterior mean and variance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="fu">mean</span>(pi_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2404674</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a><span class="fu">var</span>(pi_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0003437017</code></pre>
</div>
</div>
</section>
<section id="assessing-accuracy" class="slide level2">
<h2>Assessing accuracy</h2>
<div>

</div>
<div class="cell quarto-layout-panel" data-layout-ncol="1" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-monte-carlo_files/figure-revealjs/unnamed-chunk-10-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="additional-posterior-summaries" class="slide level2">
<h2>Additional posterior summaries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a></a><span class="co"># median</span></span>
<span id="cb6-2"><a></a><span class="fu">median</span>(pi_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2402345</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a></a><span class="co"># 95% credible intervals</span></span>
<span id="cb8-2"><a></a><span class="fu">quantile</span>(pi_samples, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.2035750 0.2784977 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="co"># evaluating probability</span></span>
<span id="cb10-2"><a></a><span class="fu">mean</span>(pi_samples <span class="sc">&lt;</span> <span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6992</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a></a><span class="co"># summarizing arbitrary functions of the parameters</span></span>
<span id="cb12-2"><a></a>pi_new <span class="ot">&lt;-</span> pi_samples<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> pi_samples</span>
<span id="cb12-3"><a></a><span class="fu">c</span>(<span class="fu">mean</span>(pi_new), <span class="fu">quantile</span>(pi_new, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5%      97.5% 
-0.2264329 -0.2568972 -0.1951383 </code></pre>
</div>
</div>
</section></section>
<section>
<section id="additional-examples-of-mc-sampling" class="title-slide slide level1 center">
<h1>Additional examples of MC sampling</h1>

</section>
<section id="poisson-random-variable" class="slide level2">
<h2>Poisson random variable</h2>
<p>Suppose that <span class="math inline">\(Y_i \stackrel{iid}{\sim} Poisson(\lambda)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>. Assume the following conjugate prior, <span class="math inline">\(f(\lambda) \sim Gamma(a, b)\)</span>, so that <span class="math inline">\(f(\lambda|\mathbf{Y}) \sim Gamma(a + \sum_{i=1}^nY_i,b+n)\)</span>. We would like to perform inference for the <span class="math inline">\(\lambda\)</span>. We take <span class="math inline">\(S=10,000\)</span> samples.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a><span class="fu">set.seed</span>(<span class="dv">54</span>) <span class="co"># set seed for replicability</span></span>
<span id="cb14-2"><a></a>S <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># number of Monte Carlo samples</span></span>
<span id="cb14-3"><a></a>lambda <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># true value of lambda</span></span>
<span id="cb14-4"><a></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># sample size</span></span>
<span id="cb14-5"><a></a>Y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, lambda)</span>
<span id="cb14-6"><a></a>a <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># hyperprior</span></span>
<span id="cb14-7"><a></a>b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># hyperprior</span></span>
<span id="cb14-8"><a></a>samples <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(S, a <span class="sc">+</span> <span class="fu">sum</span>(Y), b <span class="sc">+</span> n) <span class="co"># sample from posterior</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">min</th>
<th style="text-align: right;">q1</th>
<th style="text-align: right;">median</th>
<th style="text-align: right;">q3</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3.269</td>
<td style="text-align: right;">3.904</td>
<td style="text-align: right;">4.039</td>
<td style="text-align: right;">4.173</td>
<td style="text-align: right;">4.773</td>
<td style="text-align: right;">4.041</td>
<td style="text-align: right;">0.201</td>
</tr>
</tbody>
</table>
</div>
</div>
<!-- ## Binomial random variable -->
<!-- Suppose that $Y_i \stackrel{iid}{\sim} Bernoulli(\pi)$ for $i = 1,\ldots,n$. Assume the following conjugate prior, $f(\pi) \sim Beta(a, b)$, so that $f(\pi|\mathbf{Y}) \sim Beta(a + \sum_{i=1}^nY_i,b+n - \sum_{i=1}^n)$. We would like to perform inference for the $\pi$. We take $S=10,000$ samples. -->
<!-- ```{r} -->
<!-- set.seed(54) # set seed for replicability -->
<!-- S <- 10000 # number of Monte Carlo samples -->
<!-- pi <- 0.35 # true value of lambda -->
<!-- n <- 1000 # sample size -->
<!-- Y <- rbinom(n, size = 1, prob = pi) -->
<!-- a <- 1 # hyperprior -->
<!-- b <- 1 # hyperprior -->
<!-- samples <- rbeta(S, a + sum(Y), b + n - sum(Y)) # sample from posterior -->
<!-- ``` -->
<!-- ```{r, echo=FALSE} -->
<!-- samples <- data.frame(pi = samples) -->
<!-- samples |> -->
<!--   summarise(min = min(pi), q1 = quantile(pi, 0.25),  -->
<!--             median = median(pi), q3 = quantile(pi, 0.75),  -->
<!--             max = max(pi), mean = mean(pi), sd = sd(pi)) |> -->
<!--   kable(digits = 3) -->
<!-- ``` -->
</section>
<section id="sampling-for-any-distribution" class="slide level2">
<h2>Sampling for any distribution</h2>
<p>Monte Carlo sampling does not have to be used solely for posterior inference. Suppose we are interested in computed summaries for <span class="math inline">\(X_i \stackrel{iid}{\sim} N(3, 4)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>. We take <span class="math inline">\(S = 10,000\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a>S <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb15-2"><a></a>samples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(S, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb15-3"><a></a><span class="fu">library</span>(moments)</span>
<span id="cb15-4"><a></a><span class="fu">kurtosis</span>(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.041546</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="fu">skewness</span>(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.0109433</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a><span class="fu">mean</span>(samples <span class="sc">&gt;</span> <span class="dv">4</span>) <span class="co"># P(X_i &gt; 4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3087</code></pre>
</div>
</div>
</section>
<section id="combination-of-random-variables" class="slide level2">
<h2>Combination of random variables</h2>
<p>Suppose <span class="math inline">\(X_i \stackrel{iid}{\sim} N(3, 4)\)</span> and <span class="math inline">\(Y_i \stackrel{iid}{\sim} \chi^2(df=3)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>. <span class="math inline">\(X_i\)</span> and <span class="math inline">\(Y_i\)</span> are independent. We are interested in summaries of <span class="math inline">\(Z_i = X_i / Y_i\)</span>. We take <span class="math inline">\(S = 10,000\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a>S <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb21-2"><a></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(S, <span class="dv">3</span>, <span class="dv">2</span>)</span>
<span id="cb21-3"><a></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(S, <span class="dv">3</span>)</span>
<span id="cb21-4"><a></a>z <span class="ot">&lt;-</span> x <span class="sc">/</span> y</span>
<span id="cb21-5"><a></a><span class="fu">mean</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.961057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="fu">median</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.146081</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a><span class="fu">mean</span>(z <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5456</code></pre>
</div>
</div>
</section>
<section id="prepare-for-next-class" class="slide level2">
<h2>Prepare for next class</h2>
<ul>
<li><p>Complete <a href="https://biostat725-sp25.netlify.app/hw/hw-00">HW 00</a> which is due before Thursday’s class</p></li>
<li><p>Complete reading to prepare for Thursday’s lecture</p></li>
<li><p>Thursday’s lecture: Markov chain Monte Carlo</p></li>
</ul>

<div class="quarto-auto-generated-content">
<p><img src="../images/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://biostat725-sp25.netlify.app/">🔗 BIOSTAT 725 - Spring 2025</a></p>
</div>
</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/biostat725-sp25\.netlify\.app");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>