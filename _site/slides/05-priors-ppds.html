<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Prof.&nbsp;Sam Berchuck">
  <title>BIOSTAT 725 - Spring 2026 ‚Äì Priors, Posteriors, and PPDs!</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-12e9f5ab6e39b4942a5262e442dfa860.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Priors, Posteriors, and PPDs!</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Sam Berchuck 
</div>
</div>
</div>

  <p class="date">Jan 22, 2026</p>
</section>
<section id="review-of-last-lecture" class="slide level2">
<h2>Review of last lecture</h2>
<p>On Tuesday, we learned about Stan</p>
<ul>
<li><p>A probabilistic programming language for Bayesian inference</p></li>
<li><p>We learned about the <strong>data</strong>, <strong>parameter</strong>, and <strong>model</strong> code chunks</p></li>
<li><p>We used Stan to fit a Bayesian linear regression</p></li>
</ul>
<p>Today, we will dive into priors, posterior summaries, and posterior predictive distributions (PPDs)</p>
</section>
<section>
<section id="priors" class="title-slide slide level1 center">
<h1>Priors</h1>

</section>
<section id="prior-elicitation" class="slide level2">
<h2>Prior elicitation</h2>
<ul>
<li><p>Selecting the prior is one of the most important steps in a Bayesian analysis.</p></li>
<li><p>There is no ‚Äúright‚Äù way to select a prior.</p></li>
<li><p>The choices often depend on the objective of the study and the nature of the data.</p>
<ol type="1">
<li><p>Conjugate versus non-conjugate</p></li>
<li><p>Informative versus uninformative</p></li>
<li><p>Proper versus improper</p></li>
<li><p>Subjective versus objective</p></li>
</ol></li>
</ul>
</section>
<section id="conjugate-priors" class="slide level2">
<h2>Conjugate priors</h2>
<ul>
<li><p>A prior is conjugate if the posterior is a member of the same parametric family.</p></li>
<li><p>We have seen that if the response is normal and we use a normal prior on the regression parameter, the posterior is also a normal (if we use an inverse gamma distribution for the variance, the posterior is also inverse gamma).</p>
<ul>
<li><p>This requires a pairing of the likelihood and prior.</p></li>
<li><p>There is a long list of <a href="https://en.wikipedia.org/wiki/Conjugate_prior">conjugate priors</a>.</p></li>
</ul></li>
<li><p>The advantage of a conjugate prior is that the posterior is available in closed form.</p></li>
<li><p>No longer critical with Stan!</p></li>
</ul>
</section>
<section id="informative-versus-uninformative-priors" class="slide level2">
<h2>Informative versus uninformative priors</h2>
<ul>
<li><p>In some cases informative priors are available.</p></li>
<li><p>Potential sources include: literature reviews; pilot studies; expert opinions; etc.</p></li>
<li><p>Prior elicitation is the process of converting expert information to prior distribution.</p></li>
<li><p>For example, the expert might not comprehend an inverse gamma pdf, but if they give you an estimate and a spread you can back out <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>.</p></li>
</ul>
</section>
<section id="informative-versus-uninformative-priors-1" class="slide level2">
<h2>Informative versus uninformative priors</h2>
<ul>
<li><p>Strong priors for the parameters of interest can be hard to defend.</p></li>
<li><p>Strong priors for nuisance parameters are more common.</p></li>
<li><p>For example, say you are doing a Bayesian t-test to study the mean <span class="math inline">\(\mu\)</span>, you might use an informative prior for the nuisance parameter <span class="math inline">\(\sigma^2\)</span>.</p></li>
<li><p>Any time informative priors are used you should conduct a sensitivity analysis.</p>
<ul>
<li>That is, compare the posterior for several priors.</li>
</ul></li>
</ul>
</section>
<section id="informative-versus-uninformative-priors-2" class="slide level2">
<h2>Informative versus uninformative priors</h2>
<ul>
<li><p>In most cases prior information is not available and so uninformative priors are used.</p></li>
<li><p>Other names: vague, weak, flat, diffuse, etc.</p>
<ul>
<li>These all refer to priors with large variance.</li>
</ul></li>
<li><p>Examples: <span class="math inline">\(\theta \sim Uniform(0, 1)\)</span> or <span class="math inline">\(\mu ‚àº N(0, 1000^2)\)</span></p></li>
<li><p>Uninformative priors can be conjugate or not conjugate.</p></li>
<li><p>The idea is that the likelihood overwhelms the prior.</p></li>
<li><p>You should verify this with a sensitivity analysis.</p></li>
</ul>
</section>
<section id="improper-priors" class="slide level2">
<h2>Improper priors</h2>
<ul>
<li><p>Extreme case: <span class="math inline">\(\mu \sim N(0, \tau^2)\)</span> and we set <span class="math inline">\(\tau = \infty\)</span>.</p></li>
<li><p>A ‚Äúprior‚Äù that doesn‚Äôt integrate to one is called <strong>improper</strong>.</p></li>
<li><p>Example: <span class="math inline">\(f(\mu) = 1\)</span> for all <span class="math inline">\(\mu \in \mathbb{R}\)</span>.</p></li>
<li><p>It‚Äôs OK to use an improper prior so long as you verify that the posterior integrates to one.</p></li>
<li><p>For example, in linear regression an improper prior can be used for the slopes as long as the number of observations exceeds the number of covariates and there are no redundant predictors.</p></li>
</ul>
</section>
<section id="subjective-versus-objective-priors" class="slide level2">
<h2>Subjective versus objective priors</h2>
<ul>
<li><p>A subjective Bayesian picks a prior that corresponds to their current state of knowledge before collecting data.</p></li>
<li><p>Of course, if the reader does not share this prior then they might not accept the analysis, and so sensitivity analysis is common.</p></li>
<li><p>An <strong>objective analysis</strong> is one that requires no subjective decisions by the analyst.</p></li>
<li><p>Subjective decisions include picking the likelihood, treatment of outliers, transformations, ‚Ä¶ and prior specification.</p></li>
<li><p>A completely objective analysis may be feasible in tightly controlled experiments, but is impossible in many analyses.</p></li>
</ul>
</section>
<section id="objective-bayes" class="slide level2">
<h2>Objective Bayes</h2>
<ul>
<li><p>An objective Bayesian attempts to replace the subjective choice of prior with an algorithm that determines the prior.</p></li>
<li><p>There are many approaches: Jeffreys, reference, probability matching, maximum entropy, empirical Bayes, penalized complexity, etc.</p></li>
<li><p>Jeffreys priors are the most common: <span class="math inline">\(f(\boldsymbol{\theta}) \propto \sqrt{\det[I(\boldsymbol{\theta})]}\)</span>, where <span class="math inline">\(I(\boldsymbol{\theta})_{ij} = \mathbb{E}\left[\frac{f(\mathbf{Y}|\boldsymbol{\theta})}{\partial \theta_i}\frac{f(\mathbf{Y}|\boldsymbol{\theta})}{\partial \theta_j}\right]\)</span> is the Fisher Information matrix.</p></li>
<li><p>Many of these priors are improper and so you have to check that the posterior is proper.</p></li>
</ul>
</section>
<section id="hyperpriors" class="slide level2">
<h2>Hyperpriors</h2>
<p><strong>Prior</strong> is the name for the distribution of model parameters that show up in the likelihood.</p>
<ul>
<li>For example: In linear regression, <span class="math inline">\(\boldsymbol{\beta}\)</span> and <span class="math inline">\(\sigma^2\)</span> are parameters in the likelihood, thus <span class="math inline">\(f(\boldsymbol{\beta})\)</span> and <span class="math inline">\(f(\sigma^2)\)</span> are called priors.</li>
</ul>
<p><strong>Hyperprior</strong> is the name for the distribution of model parameters not in the likelihood.</p>
<p><strong>Hyperparameter</strong> is the name for the parameters in a hyperprior.</p>
</section>
<section id="hyperpriors-1" class="slide level2">
<h2>Hyperpriors</h2>
<ul>
<li><p>For example: Suppose in linear regression, we place the following prior for <span class="math inline">\(\boldsymbol{\beta}\)</span>, <span class="math inline">\(f(\boldsymbol{\beta} | \boldsymbol{\beta}_0, \sigma_{\beta}^2) = N(\boldsymbol{\beta}_0,\sigma_{\beta}^2 \mathbf{I})\)</span> and</p>
<ul>
<li><p><span class="math inline">\(f(\boldsymbol{\beta}_0) = N(\mathbf{0}, \mathbf{I})\)</span></p></li>
<li><p><span class="math inline">\(f(\sigma_{\beta}^2) = IG(a_{\beta}, b_{\beta})\)</span></p></li>
</ul></li>
<li><p><span class="math inline">\(f(\boldsymbol{\beta}_0)\)</span> and <span class="math inline">\(f(\sigma_{\beta}^2)\)</span> are <strong>hyperpriors</strong>.</p></li>
<li><p><span class="math inline">\(a_{\beta}, b_{\beta}\)</span> are <strong>hyperparameters</strong>.</p></li>
</ul>
<div class="fragment">
<p><strong>Question:</strong> Why would a researcher be interested in a hyperprior?</p>
</div>
</section>
<section id="prior-predictive-checks" class="slide level2">
<h2>Prior predictive checks</h2>
<ul>
<li>Use the prior distribution to obtain samples of the data, <span class="math inline">\(\mathbf{Y}\)</span>.</li>
</ul>
<p><span class="math display">\[\begin{aligned}
f(\mathbf{Y}) &amp;= \int f(\mathbf{Y}, \boldsymbol{\theta}) d\boldsymbol{\theta}\\
&amp;= \int f(\mathbf{Y} | \boldsymbol{\theta})f(\boldsymbol{\theta}) d\boldsymbol{\theta}
\end{aligned}\]</span></p>
<ul>
<li><p>This is easy to sample from using the following steps, 1. <span class="math inline">\(\boldsymbol{\theta}^{sim} \sim f(\boldsymbol{\theta})\)</span> and 2. <span class="math inline">\(\mathbf{Y}^{sim} \sim f(\mathbf{Y} | \boldsymbol{\theta}^{sim})\)</span>.</p></li>
<li><p>Similar to Gibbs sampling, this gives a sample from the joint <span class="math inline">\((\mathbf{Y}^{sim}, \boldsymbol{\theta}^{sim})\)</span> and also the marginal <span class="math inline">\(\mathbf{Y}^{sim}\)</span>.</p></li>
</ul>
</section>
<section id="prior-predictive-checks-1" class="slide level2">
<h2>Prior predictive checks</h2>
<ul>
<li><p>Suppose that I am interested in modeling the number of patients who are in the waiting room during an hour in the Duke ED, <span class="math inline">\(Y_i\)</span>.</p></li>
<li><p>We can model this random variable as <span class="math inline">\(Y_i \stackrel{iid}{\sim}Poisson(\lambda)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>. A conjugate prior for <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\lambda \sim Gamma(a,b)\)</span>.</p></li>
<li><p>We know from experience that on average there are 20 patients waiting during an hour, so we want <span class="math inline">\(\mathbb{E}[Y_i]=\lambda = 20\)</span>.</p></li>
<li><p>Thus, we place a prior on <span class="math inline">\(\lambda\)</span> that is centered at 20, which requires that <span class="math inline">\(a/b=20\)</span>.</p></li>
<li><p>There are infinitely many priors specifications.</p></li>
</ul>
</section>
<section id="prior-predictive-checks-2" class="slide level2">
<h2>Prior predictive checks</h2>
<ul>
<li>Prior predictive checks can be used to determine a realistic specification for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>.</li>
</ul>
<div class="cell" data-output.var="prior pc">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb1-1"><a></a><span class="kw">data</span> {</span>
<span id="cb1-2"><a></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; n;</span>
<span id="cb1-3"><a></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>&gt; a;</span>
<span id="cb1-4"><a></a>  <span class="dt">real</span>&lt;<span class="kw">lower</span> = <span class="dv">0</span>&gt; b;</span>
<span id="cb1-5"><a></a>}</span>
<span id="cb1-6"><a></a><span class="kw">generated quantities</span> {</span>
<span id="cb1-7"><a></a>  <span class="dt">real</span> lambda = gamma_rng(a, b);</span>
<span id="cb1-8"><a></a>  <span class="dt">vector</span>[n] y_sim;</span>
<span id="cb1-9"><a></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:n) y_sim[i] = poisson_rng(lambda);</span>
<span id="cb1-10"><a></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<ul>
<li>When running Stan for prior predictive checks you must specify <code>algorithm = "Fixed_param"</code></li>
</ul>
</section>
<section id="visualizing-prior-predictive-checks" class="slide level2 midi">
<h2>Visualizing prior predictive checks</h2>
<div class="cell quarto-layout-panel" data-layout-nrow="1" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-priors-ppds_files/figure-revealjs/unnamed-chunk-4-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
<ul>
<li>We can use the samples of <span class="math inline">\(Y_i\)</span> under different prior specifications to compute a summary statstic, for example for the maximum value.</li>
</ul>
</section></section>
<section>
<section id="posterior-summaries" class="title-slide slide level1 center">
<h1>Posterior summaries</h1>

</section>
<section id="posterior-summaries-point-estimates" class="slide level2 midi">
<h2>Posterior summaries: point estimates</h2>
<ul>
<li><p>The output of Bayesian inference is a probability distribution. It is often convenient to summarize the posterior in various ways.</p></li>
<li><p>Usually summaries are computed for individual parameters using the marginal distributions,</p></li>
</ul>
<p><span class="math display">\[f(\theta_i|\mathbf{Y}) = \int f(\boldsymbol{\theta} | \mathbf{Y}) d\boldsymbol{\theta}_{-i}.\]</span></p>
<ul>
<li>The <strong>posterior mean</strong> is defined by,</li>
</ul>
<p><span class="math display">\[\int_{-\infty}^{\infty}\theta_i f(\theta_i|\mathbf{Y}) d\theta_i.\]</span></p>
</section>
<section id="posterior-summaries-point-estimates-1" class="slide level2">
<h2>Posterior summaries: point estimates</h2>
<ul>
<li>The <strong>posterior median</strong> <em>m</em> is defined by,</li>
</ul>
<p><span class="math display">\[\int_{-\infty}^{m} f(\theta_i|\mathbf{Y}) d\theta_i = 0.5 = \int_m^{\infty} f(\theta_i|\mathbf{Y}) d\theta_i.\]</span></p>
<ul>
<li>The <strong>posterior mode</strong> is given by,</li>
</ul>
<p><span class="math display">\[M=\text{argmax} f(\theta_i|\mathbf{Y}) \]</span></p>
<ul>
<li>The mean and mode are also well defined for the joint posterior distribution.</li>
</ul>
</section>
<section id="posterior-summaries-intervals" class="slide level2">
<h2>Posterior summaries: intervals</h2>
<ul>
<li><p>The Bayesian analogue of a frequentist confidence interval is a <strong>credible interval</strong>.</p></li>
<li><p>An interval <span class="math inline">\((a,b)\)</span> is a <span class="math inline">\(100(1-\alpha)\%\)</span> posterior credible interval for <span class="math inline">\(\theta_i\)</span> if</p></li>
</ul>
<p><span class="math display">\[\int_a^b f(\theta_i|\mathbf{Y}) d\theta_i = (1-\alpha),\quad 0\leq \alpha \leq 1.\]</span></p>
<ul>
<li>A <strong>credible region</strong> can be defined similarly for a joint distribution.</li>
</ul>
</section>
<section id="posterior-summaries-intervals-1" class="slide level2">
<h2>Posterior summaries: intervals</h2>
<ul>
<li><p>Credible intervals are not unique. The two most common are <strong>symmetric</strong> and <strong>highest posterior density (HPD)</strong>.</p>
<ul>
<li>Symmetric: An interval <span class="math inline">\((a,b)\)</span> is a symmetric <span class="math inline">\(100(1-\alpha)\%\)</span> credible interval if,</li>
</ul>
<p><span class="math display">\[\int_{-\infty}^a f(\theta_i|\mathbf{Y}) d\theta_i = \frac{\alpha}{2} = \int_b^{\infty} f(\theta_i|\mathbf{Y}) d\theta_i.\]</span></p>
<ul>
<li><p>Highest posterior density (HPD): An interval <span class="math inline">\((a,b)\)</span> is a <span class="math inline">\(100(1-\alpha)\%\)</span> HPD interval if,</p>
<ol type="1">
<li><p><span class="math inline">\([a,b]\)</span> is a <span class="math inline">\(100(1-\alpha)\%\)</span> credible interval for <span class="math inline">\(\theta_i\)</span></p></li>
<li><p>For all <span class="math inline">\(\theta_i \in [a,b]\)</span> and <span class="math inline">\(\theta_i^* \notin [a,b]\)</span>, <span class="math inline">\(f(\theta_i|\mathbf{Y}) \geq f(\theta_i^*|\mathbf{Y})\)</span></p></li>
</ol></li>
</ul></li>
</ul>
</section>
<section id="posterior-summaries-hpd-credible-interval" class="slide level2">
<h2>Posterior summaries: HPD credible interval</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/05/hpd.png" class="quarto-figure quarto-figure-center" style="height:5in" alt="hpd-hoff"></p>
</figure>
</div>
</section>
<section id="posterior-summaries-hpd-credible-interval-1" class="slide level2">
<h2>Posterior summaries: HPD credible interval</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/05/hpd-other.png" class="quarto-figure quarto-figure-center" style="height:5in" alt="hpd-other"></p>
</figure>
</div>
</section>
<section id="posterior-summaries-probability" class="slide level2">
<h2>Posterior summaries: probability</h2>
<ul>
<li><p>We may be interested in a hypothesis test: <span class="math inline">\(H_0: \theta \leq c\)</span> versus <span class="math inline">\(H_1: \theta \geq c\)</span></p></li>
<li><p>We can report the posterior probability of the null hypothesis</p>
<ul>
<li><span class="math inline">\(P(\theta \leq c | \mathbf{Y}) = \mathbb{E}[1(\theta \leq c) | \mathbf{Y}]\)</span></li>
</ul></li>
<li><p>Interpretation of the posteriour probability:</p>
<ul>
<li>Probability that the null is true <span class="math inline">\(P(\theta \leq c | \mathbf{Y})\)</span></li>
</ul></li>
<li><p>Interpretation of the p-value:</p>
<ul>
<li><p>Probability of observing a test-statistic as or more extreme given that the null is true</p></li>
<li><p>Evidence for or against the null (reject or fail to reject)</p></li>
</ul></li>
</ul>
</section>
<section id="posterior-summaries-estimation" class="slide level2">
<h2>Posterior summaries: estimation</h2>
<ul>
<li><p>We have already seen that we can use MC or MCMC to estimate these posterior summaries!</p></li>
<li><p>To compute the HPD interval we can use the <code>hdi</code> function from the <code>ggdist</code> R package</p></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a><span class="fu">library</span>(ggdist)</span>
<span id="cb2-2"><a></a>y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">10000</span>, <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb2-3"><a></a><span class="fu">quantile</span>(y, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.6184613 7.2143297 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>ggdist<span class="sc">::</span><span class="fu">hdi</span>(y)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          [,1]     [,2]
[1,] 0.2539334 6.291464</code></pre>
</div>
</div>
</section></section>
<section>
<section id="posterior-predictive-distribution-ppd" class="title-slide slide level1 center">
<h1>Posterior predictive distribution (PPD)</h1>

</section>
<section id="linear-regression-recall" class="slide level2">
<h2>Linear regression recall</h2>
<ul>
<li><p>Assume we observe <span class="math inline">\((Y_i,\mathbf{x}_i)\)</span> for <span class="math inline">\(i = 1,\ldots,n\)</span>, where <span class="math display">\[Y_i|\boldsymbol{\beta},\sigma^2 \sim N(\mathbf{x}_i \boldsymbol{\beta}, \sigma^2).\]</span></p></li>
<li><p>The full data likelihood is given by, <span class="math display">\[f(\mathbf{Y} | \boldsymbol{\beta},\sigma^2) = \prod_{i=1}^n f(Y_i|\boldsymbol{\beta},\sigma^2),\]</span> where <span class="math inline">\(\mathbf{Y} = (Y_1,\ldots,Y_n)\)</span>.</p></li>
<li><p>We have parameters <span class="math inline">\(\boldsymbol{\theta} = (\boldsymbol{\beta}^\top,\sigma^2)\)</span> and <span class="math inline">\(f(\boldsymbol{\theta}) = f(\boldsymbol{\beta})f(\sigma^2)\)</span>.</p></li>
</ul>
</section>
<section id="posterior-predictive-distribution-definition" class="slide level2 midi">
<h2>Posterior predictive distribution: definition</h2>
<ul>
<li><p>Assume we observe a new <span class="math inline">\(\mathbf{x}'\)</span> and we would like to make some type of prediction about <span class="math inline">\(Y'\)</span> given the data we have already observed, <span class="math inline">\(\mathbf{Y}\)</span>.</p></li>
<li><p>The <strong>posterior predictive distribution</strong> is defined as <span class="math inline">\(f(Y'|\mathbf{Y})\)</span> and can be written as, <span class="math display">\[\begin{aligned}
f(Y' | \mathbf{Y}) &amp;= \int f(Y' , \boldsymbol{\theta} | \mathbf{Y}) d\boldsymbol{\theta},\quad\text{(marginal)}\\
&amp;= \int f(Y' | \boldsymbol{\theta},\mathbf{Y}) f(\boldsymbol{\theta} | \mathbf{Y})d\boldsymbol{\theta},\quad\text{(conditional)}\\
&amp;= \int \underbrace{f(Y' | \boldsymbol{\theta})}_{likelihood} \underbrace{f(\boldsymbol{\theta} | \mathbf{Y})}_{posterior}d\boldsymbol{\theta}.\quad\text{(independence)}
\end{aligned}\]</span></p></li>
</ul>
</section>
<section id="posterior-predictive-distribution-estimation" class="slide level2 midi">
<h2>Posterior predictive distribution: estimation</h2>
<ul>
<li>The PPD can be written as an expectation,</li>
</ul>
<p><span class="math display">\[f(Y' | \mathbf{Y})  = \int f(Y' | \boldsymbol{\theta}) f(\boldsymbol{\theta} | \mathbf{Y})d\boldsymbol{\theta} = \mathbb{E}_{\boldsymbol{\theta} | \mathbf{Y}}\left[f(Y' | \boldsymbol{\theta})\right].\]</span></p>
<ul>
<li>Thus, we can estimate the PPD using a Monte Carlo estimate,</li>
</ul>
<p><span class="math display">\[\mathbb{E}_{\boldsymbol{\theta} | \mathbf{Y}}\left[f(Y' | \boldsymbol{\theta})\right] \approx \frac{1}{S} \sum_{s = 1}^S f\left(Y' | \boldsymbol{\theta}^{(s)}\right),\]</span></p>
<p>where <span class="math inline">\(\left\{\boldsymbol{\theta}^{(1)},\ldots,\boldsymbol{\theta}^{(S)}\right\}\)</span> are samples from the posterior.</p>
</section>
<section id="posterior-predictive-distribution-stan" class="slide level2">
<h2>Posterior predictive distribution: Stan</h2>
<ul>
<li><p>We want to compute the posterior predictive distribution.</p></li>
<li><p>Use <strong>generated quantities</strong> block.</p></li>
</ul>
<div class="cell" data-output.var="ppd">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb6-1"><a></a><span class="kw">generated quantities</span> {</span>
<span id="cb6-2"><a></a>  <span class="dt">vector</span>[n] in_sample;</span>
<span id="cb6-3"><a></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:n) {</span>
<span id="cb6-4"><a></a>    in_sample[i] = normal_rng(X[i] * beta, sigma);</span>
<span id="cb6-5"><a></a>  }</span>
<span id="cb6-6"><a></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="posterior-predictive-distribution-stan-1" class="slide level2 midi">
<h2>Posterior predictive distribution: Stan</h2>
<div class="cell" data-output.var="ppd">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb7-1"><a></a><span class="kw">generated quantities</span> {</span>
<span id="cb7-2"><a></a>  <span class="dt">vector</span>[n] in_sample;</span>
<span id="cb7-3"><a></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:n) {</span>
<span id="cb7-4"><a></a>    in_sample[i] = normal_rng(X[i] * beta, sigma);</span>
<span id="cb7-5"><a></a>  }</span>
<span id="cb7-6"><a></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The function <code>normal_rng</code> generates a single independent sample from a normal distribution with parameters:</p>
<ul>
<li><p><code>mean = X[i, ] * beta</code>, where <code>beta</code> is a sample from the estimated posterior.</p></li>
<li><p><code>sd = sigma</code>, where <code>sigma</code> is a sample from the estimated posterior.</p></li>
</ul>
<p>This computes the posterior predictive distribution for the original data.</p>
</section>
<section id="posterior-predictive-distribution-stan-2" class="slide level2 midi">
<h2>Posterior predictive distribution: Stan</h2>
<p>The following additions are added to the linear regression Stan code.</p>
<div class="cell" data-output.var="ppd">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb8-1"><a></a><span class="co">// saved in linear_regression_ppd.stan</span></span>
<span id="cb8-2"><a></a><span class="kw">data</span> {</span>
<span id="cb8-3"><a></a>  ...</span>
<span id="cb8-4"><a></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span> = <span class="dv">1</span>&gt; n_pred; <span class="co">// number of new observations</span></span>
<span id="cb8-5"><a></a>  <span class="dt">matrix</span>[n_pred, p + <span class="dv">1</span>] X_pred; <span class="co">// covariate matrix for new observations</span></span>
<span id="cb8-6"><a></a>}</span>
<span id="cb8-7"><a></a><span class="kw">generated quantities</span> {</span>
<span id="cb8-8"><a></a>  <span class="dt">vector</span>[n] in_sample;</span>
<span id="cb8-9"><a></a>  <span class="dt">vector</span>[n_pred] out_sample;</span>
<span id="cb8-10"><a></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:n) {</span>
<span id="cb8-11"><a></a>    in_sample[i] = normal_rng(X[i, ] * beta, sigma);</span>
<span id="cb8-12"><a></a>  }</span>
<span id="cb8-13"><a></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span>:n_pred) {</span>
<span id="cb8-14"><a></a>    out_sample[i] = normal_rng(X_pred[i, ] * beta, sigma);</span>
<span id="cb8-15"><a></a>  }</span>
<span id="cb8-16"><a></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="lets-simulate-some-data-again" class="slide level2">
<h2>Let‚Äôs simulate some data again</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="do">###True parameters</span></span>
<span id="cb9-2"><a></a>sigma <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="co"># true measurement error</span></span>
<span id="cb9-3"><a></a>beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">1</span>) <span class="co"># true beta</span></span>
<span id="cb9-4"><a></a></span>
<span id="cb9-5"><a></a><span class="do">###Simulation settings</span></span>
<span id="cb9-6"><a></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of observations</span></span>
<span id="cb9-7"><a></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(beta) <span class="sc">-</span> <span class="dv">1</span> <span class="co"># number of covariates</span></span>
<span id="cb9-8"><a></a>n_pred <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb9-9"><a></a>  </span>
<span id="cb9-10"><a></a><span class="do">###Simulate data</span></span>
<span id="cb9-11"><a></a><span class="fu">set.seed</span>(<span class="dv">54</span>) <span class="co"># set seed</span></span>
<span id="cb9-12"><a></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> p), <span class="at">ncol =</span> p))</span>
<span id="cb9-13"><a></a>Y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(X <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma))</span>
<span id="cb9-14"><a></a>X_pred <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>, <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n_pred <span class="sc">*</span> p), <span class="at">ncol =</span> p))</span>
<span id="cb9-15"><a></a>Y_pred <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(X_pred <span class="sc">%*%</span> beta <span class="sc">+</span> <span class="fu">rnorm</span>(n_pred, <span class="dv">0</span>, sigma))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="fit-linear-regression-using-stan" class="slide level2">
<h2>Fit linear regression using Stan</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a></a><span class="do">###Load packages</span></span>
<span id="cb10-2"><a></a><span class="fu">library</span>(rstan)</span>
<span id="cb10-3"><a></a></span>
<span id="cb10-4"><a></a><span class="do">###Create stan data object</span></span>
<span id="cb10-5"><a></a>stan_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> n, <span class="at">p =</span> p, <span class="at">Y =</span> Y, <span class="at">X =</span> X,</span>
<span id="cb10-6"><a></a>                  <span class="at">beta0 =</span> <span class="dv">0</span>, <span class="at">sigma_beta =</span> <span class="dv">10</span>, <span class="at">a =</span> <span class="dv">3</span>,  <span class="at">b =</span> <span class="dv">1</span>,</span>
<span id="cb10-7"><a></a>                  <span class="at">n_pred =</span> n_pred, <span class="at">X_pred =</span> X_pred)</span>
<span id="cb10-8"><a></a>  </span>
<span id="cb10-9"><a></a><span class="do">###Compile model separately</span></span>
<span id="cb10-10"><a></a>stan_model <span class="ot">&lt;-</span> <span class="fu">stan_model</span>(<span class="at">file =</span> <span class="st">"linear_regression_ppd.stan"</span>)</span>
<span id="cb10-11"><a></a></span>
<span id="cb10-12"><a></a><span class="do">###Run model and save</span></span>
<span id="cb10-13"><a></a>fit <span class="ot">&lt;-</span> <span class="fu">sampling</span>(stan_model, <span class="at">data =</span> stan_data, </span>
<span id="cb10-14"><a></a>                <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">iter =</span> <span class="dv">1000</span>)</span>
<span id="cb10-15"><a></a><span class="fu">saveRDS</span>(fit, <span class="at">file =</span> <span class="st">"linear_regression_ppd_fit.rds"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="examining-prediction-performance" class="slide level2 midi">
<h2>Examining prediction performance</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="do">###Inspect the ppd</span></span>
<span id="cb11-2"><a></a>ppds <span class="ot">&lt;-</span> <span class="fu">extract</span>(fit, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">"in_sample"</span>, <span class="st">"out_sample"</span>))</span>
<span id="cb11-3"><a></a><span class="fu">lapply</span>(ppds, dim)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$in_sample
[1] 2000  100

$out_sample
[1] 2000   10</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell quarto-layout-panel" data-layout-nrow="1" data-layout-align="center">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="05-priors-ppds_files/figure-revealjs/unnamed-chunk-13-1.png" class="quarto-figure quarto-figure-center" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="prepare-for-next-class" class="slide level2">
<h2>Prepare for next class</h2>
<ul>
<li><p>Work on <a href="https://biostat725-sp26.netlify.app/hw/hw-01">HW 01</a> which is due next Thursday before class</p></li>
<li><p>Complete reading to prepare for next Tuesday‚Äôs lecture</p></li>
<li><p>Tuesday‚Äôs lecture: Model checking</p></li>
</ul>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../images/logo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://biostat725-sp26.netlify.app/">üîó BIOSTAT 725 - Spring 2026</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/biostat725-sp26\.netlify\.app");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>