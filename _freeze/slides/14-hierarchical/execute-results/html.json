{
  "hash": "4fd91ab6823f3585484bd9b38624d1aa",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hierarchical Models\"\nauthor: \"Prof. Sam Berchuck\"\ndate: \"2026-02-24\"\ndate-format: \"MMM DD, YYYY\"\nfooter: \"[ðŸ”— BIOSTAT 725 - Spring 2026](https://biostat725-sp26.netlify.app/)\"\nlogo: \"../images/logo.png\"\nformat: \n  revealjs:\n    theme: slides.scss\n    multiplex: false\n    transition: fade\n    slide-number: true\n    incremental: false \n    chalkboard: true\n    html-math-method: mathjax\nfilters:\n  - parse-latex\nexecute:\n  freeze: auto\n  echo: true\nknitr:\n  opts_chunk: \n    R.options:      \n    width: 200\nbibliography: references.bib\n---\n\n\n::: {.cell}\n\n:::\n\n\n## Review of last lecture\n\n-   Last week, we learned about classification for binary and multiclass problems.\n\n-   **Moving forward:** Up until today, we have dealt with independent data. Today, we will look at our first example of dependent data!\n\n## Linear regression assumptions\n\n\\begin{align*}\nY_i &= \\alpha + \\mathbf{x}_i \\boldsymbol{\\beta} + \\epsilon_i,\\quad \\epsilon_i \\sim N(0,\\sigma^2)\\\\\n&= \\mu_i + \\epsilon_i.\n\\end{align*}\n\nAssumptions:\n\n1.  $Y_i$ are independent observations (independence).\n\n2.  $Y_i$ is linearly related to $\\mathbf{x}_i$ (linearity).\n\n3.  $\\epsilon_i = Y_i - \\mu_i$ is normally distributed (normality).\n\n4.  $\\epsilon_i$ has constant variance across $\\mathbf{x}_i$ (homoskedasticity).\n\n## Independence Assumption in Linear Regression\n\nWe assume that the residuals $\\epsilon_i$ are independent:\n\n$$\\mathbb{C}(\\epsilon_i, \\epsilon_j) = 0, \\quad \\text{for} \\quad i \\neq j,$$ where $\\mathbb{C}(X, Y)$ is the covariance between two random variables $X$ and $Y$. As a note: $\\mathbb{C}(X, X) = \\mathbb{V}(X)$.\n\n-   This implies that the observations $Y_i$ and $Y_j$ are independent, and their correlation is zero.\n\n    -   Correlation: $\\rho(X,Y) = \\frac{\\mathbb{C}(X, Y)}{\\sqrt{\\mathbb{V}(X)\\mathbb{V}(Y)}}$.\n\n## Real-World: Dependent Observations\n\nHowever, in real-world data, the independence assumption often does not hold:\n\n-   **Repeated measures data** (e.g., same individual over time).\n\n-   **Clustered data** (e.g., patients within a hospital).\n\n-   **Longitudinal data** (e.g., disease severity measures over time).\n\n-   **Spatial data** (e.g., disease counts observed across zip codes).\n\n## The Challenge\n\n-   If we assume independence in the presence of correlation:\n\n    1.  **Biased parameter estimates**: Parameter estimation will be biased due to group-level dependencies that effect the outcome.\n\n    2.  **Underestimated uncertainty**: The model will not account for the true variability, leading to narrower confidence intervals.\n\n    3.  **Inaccurate Predictions**: Predictions for new groups may be biased because the model doesn't properly account for group-level variability.\n\n-   Thus, we need a way to account for dependencies between observations, especially when data are grouped or clustered.\n\n## Example of Hierarchical Data\n\n-   Hierarchical data refers to data that is organized into groups or clusters, where each group contains multiple observations.\n\n-   Consider data from patients within hospitals. Each patient is being treated in a hospital, with multiple patients belonging to each hospital.\n\n-   In this case, the observation for a patient is indexed by two variables:\n\n    -   $i$: hospital index.\n\n    -   $j$: patient index, nested within hospital.\n\n-   So, for patient $j$ within hospital $i$, we write the response as $Y_{ij}$.\n\n## Observations with Two Indices: $Y_{ij}$\n\n-   $Y_{ij}$ represents the response for patient $j$ in hospital $i$.\n\n-   The first index $i$ represents group-level effects (e.g., hospital-level).\n\n-   The second index $j$ represents individual-level observations (e.g., patient).\n\n-   We typically say that $i = 1,\\ldots,n.$ and $j = 1,\\ldots,n_i$.\n\n-   The total number of observations is $N = \\sum_{i = 1}^{n}n_i$.\n\n## Why Two Indices?\n\nHaving two indices allows us to model both:\n\n-   **Within-group variation** (differences between patients within the same hospital).\n\n-   **Between-group variation** (differences between hospitals).\n\nThe hierarchical structure captures both types of variation.\n\n## Conceptualizing Hierarchical Data\n\nConsider the example of patients within hospitals:\n\n-   Each data point (i.e., observed data $Y_{ij}$) represents an outcome measured on a patient.\n\n-   The data points are grouped by hospital, indicating that patients from the same hospital are likely to have similar outcomes due to shared hospital-level factors.\n\nThis is a typical example of hierarchical data.\n\n## Hierarchical Model\n\nNow, we can see how hierarchical data appears in the model:\n\n$$Y_{ij} = \\alpha + \\mathbf{x}_{ij} \\boldsymbol{\\beta} + \\theta_i + \\epsilon_{ij},\\quad \\epsilon_{ij} \\stackrel{iid}{\\sim}N(0,\\sigma^2).$$\n\n**Subject-specific objects:**\n\n-   $Y_{ij}$: response for patient $j$ in hospital $i$.\n\n-   $\\mathbf{x}_{ij}$ are the predictors for patient $j$ in hospital $i$.\n\n-   $\\epsilon_{ij}$: residual error for patient $j$ in hospital $i$.\n\n## Hierarchical Model\n\nNow, we can see how hierarchical data appears in the model:\n\n$$Y_{ij} = \\alpha + \\mathbf{x}_{ij} \\boldsymbol{\\beta} + \\theta_i + \\epsilon_{ij},\\quad \\epsilon_{ij} \\stackrel{iid}{\\sim}N(0,\\sigma^2).$$\n\n**Group-specific objects:**\n\n-   $\\theta_i$: group-specific parameter for hospital $i$, accounting for hospital-level variation (group-specific, random effect).\n\nThe group-specific parameters are responsible for inducing correlation into the model.\n\n## Hierarchical Model\n\nNow, we can see how hierarchical data appears in the model:\n\n$$Y_{ij} = \\alpha + \\mathbf{x}_{ij} \\boldsymbol{\\beta} + \\theta_i + \\epsilon_{ij},\\quad \\epsilon_{ij} \\stackrel{iid}{\\sim}N(0,\\sigma^2).$$\n\n**Population parameters:**\n\n-   $\\alpha$: intercept for the entire population.\n\n-   $\\boldsymbol{\\beta}$: regression parameters for the entire population.\n\n-   $\\sigma$: residual error parameter for the entire population.\n\n## Random Intercept Model\n\n$$Y_{ij} = \\alpha + \\mathbf{x}_{ij} \\boldsymbol{\\beta} + \\theta_i + \\epsilon_{ij},\\quad \\epsilon_{ij} \\stackrel{iid}{\\sim}N(0,\\sigma^2).$$\n\n-   From a frequentist perspective, this model may be called a **random intercept** model, but in the Bayesian framework all parameters are random variables, so the terms fixed and random effects don't apply.\n\n    -   $\\theta_i$: group-specific parameters (random effect).\n\n    -   $\\alpha, \\boldsymbol{\\beta}, \\sigma$: population parameters (common across all groups, $\\boldsymbol{\\beta}$ are the fixed effects).\n\n## Prior for $\\theta_i$ {.midi}\n\nWe model $\\theta_i$ as a parameter drawn from a **normal distribution** centered at zero, with some variance $\\tau^2$:\n\n$$\\theta_i \\stackrel{iid}{\\sim} N(0, \\tau^2).$$\n\n-   **Mean at zero**: This assumption reflects that, on average, hospitals don't deviate from the population mean (helps with identifiability).\n\n-   **Variance** $\\tau^2$: This represents the variability in hospital-level intercepts. A larger $\\tau^2$ implies greater variability between hospitals.\n\nEach hospital $i$ has a **hospital-specific parameter** $\\theta_i$, which represents how that hospital's baseline (e.g., health outcomes) deviates from the population average.\n\n## Group-Specific Intercept Model: Conditional Specification\n\nFor $i = 1,\\ldots,n$ and $j = 1,\\ldots,n_i$, \\begin{align*}\nY_{ij} | \\boldsymbol{\\Omega},\\theta_i &\\stackrel{ind}{\\sim} N(\\alpha + \\mathbf{x}_{ij}\\boldsymbol{\\beta} + \\theta_i,\\sigma^2)\\\\\n\\theta_i | \\tau^2 &\\stackrel{iid}{\\sim} N(0,\\tau^2)\\\\\n\\boldsymbol{\\Omega} &\\sim f(\\boldsymbol{\\Omega}),\n\\end{align*} where $\\boldsymbol{\\Omega} = (\\alpha, \\boldsymbol{\\beta},\\sigma,\\tau)$ are the population parameters.\n\n## Group-Specific Intercept Model: Conditional Specification\n\n-   Moments for the Conditional Model:\n\n\\begin{align*}\n\\mathbb{E}[Y_{ij} | \\boldsymbol{\\Omega},\\theta_i] &= \\alpha + \\mathbf{x}_{ij}\\boldsymbol{\\beta} + \\theta_i\\\\\n\\mathbb{V}(Y_{ij} | \\boldsymbol{\\Omega},\\theta_i) &= \\sigma^2\\\\\n\\mathbb{C}(Y_{ij}, Y_{lk} | \\boldsymbol{\\Omega},\\theta_i,\\theta_l) &= 0,\\quad \\forall i,j,l,k.\n\\end{align*}\n\n## Understanding the Random Intercept\n\n-   $\\theta_i$: group-specific parameter captures group-level differences (e.g., hospital level).\n\n-   The intercept $\\theta_i$ allows for each group to have its own baseline value.\n\n-   This model introduces **dependence** within groups because observations from the same group share the same intercept $\\theta_i$.\n\n\\begin{align*}\n\\mathbb{E}[Y_{ij} | \\boldsymbol{\\Omega},\\theta_i] &= \\alpha + \\mathbf{x}_{ij} \\boldsymbol{\\beta} + \\theta_i\\\\\n&= (\\alpha + \\theta_i) + \\mathbf{x}_{ij} \\boldsymbol{\\beta}\\\\\n&= \\alpha_i + \\mathbf{x}_{ij} \\boldsymbol{\\beta}.\n\\end{align*}\n\n## Identifiability Issues\n\n-   **Population Intercept (**$\\alpha$): This is the average intercept for the entire population, i.e., the baseline outcome across all hospitals.\n\n-   **Group-Specific Intercept (**$\\alpha + \\theta_i$): The group-specific intercept, where $\\theta_i$ represents the deviation from the population intercept for group $i$.\n\nWe face an **identifiability issue** when estimating the population intercept and group-specific intercepts. We could add the same constant to all $\\theta_i$'s and subtract that constant from $\\alpha$.\n\n-   This is solved by setting $\\theta_i$ to be mean zero apriori.\n\n## Group-Specific Intercept Model: Conditional Specification\n\n-   Define $\\mathbf{Y}_i = (Y_{i1},\\ldots,Y_{in_i})$ and $\\mathbf{Y} = (\\mathbf{Y}_1,\\ldots,\\mathbf{Y}_n)$.\n\n-   The posterior for the conditional model can be written as:\n\n\\begin{align*}\nf(\\boldsymbol{\\Omega}, \\boldsymbol{\\theta} | \\mathbf{Y}) &\\propto f(\\mathbf{Y}, \\boldsymbol{\\Omega}, \\boldsymbol{\\theta})\\\\\n&= f(\\mathbf{Y} | \\boldsymbol{\\Omega}, \\boldsymbol{\\theta}) f(\\boldsymbol{\\theta} | \\boldsymbol{\\Omega})f(\\boldsymbol{\\Omega})\\\\\n&=  \\prod_{i=1}^n \\prod_{j = 1}^{n_i} f(Y_{ij} | \\boldsymbol{\\Omega}, \\boldsymbol{\\theta})  \\prod_{i=1}^n f(\\theta_i | \\tau^2) f(\\boldsymbol{\\Omega}),\n\\end{align*} where $\\boldsymbol{\\theta} = (\\theta_1,\\ldots,\\theta_n)$.\n\n## Group-Specific Intercept Model: Marginal Specification {.midi}\n\nTo derive a marginal model it is useful to write the model at the level of the independent observations, $\\mathbf{Y}_i$.\n\n$$\\mathbf{Y}_i = \\begin{bmatrix}\n    Y_{i1}\\\\\n    Y_{i2}\\\\\n    \\vdots\\\\\n    Y_{in_i}\n  \\end{bmatrix} = \n  \\begin{bmatrix}\n    \\alpha + \\mathbf{x}_{i1} \\boldsymbol{\\beta} + \\theta_i + \\epsilon_{i1}\\\\\n    \\alpha + \\mathbf{x}_{i2} \\boldsymbol{\\beta} + \\theta_i + \\epsilon_{i2}\\\\\n    \\vdots \\\\\n    \\alpha + \\mathbf{x}_{in_i} \\boldsymbol{\\beta} + \\theta_i + \\epsilon_{in_i}\n  \\end{bmatrix} = \\alpha \\mathbf{1}_{n_i} + \\mathbf{X}_i \\boldsymbol{\\beta} + \\theta_i \\mathbf{1}_{n_i} + \\boldsymbol{\\epsilon}_i,$$ where $\\mathbf{1}_{n_i}$ is an $n_i \\times 1$ dimensional vector of ones, $\\mathbf{X}_i$ is an $n_i \\times p$ dimensional matrix with rows $\\mathbf{x}_{ij}$.\n\n-   $\\boldsymbol{\\epsilon}_i = (\\epsilon_{i1},\\ldots,\\epsilon_{in_i}) \\stackrel{ind}{\\sim} N(\\mathbf{0}_{n_i}, \\sigma^2 \\mathbf{I}_{n_i})$, with $\\mathbf{0}_{n_i}$ an $n_i \\times 1$ dimensional vector of zeros.\n\n## Group-Specific Intercept Model: Marginal Specification {.midi}\n\n-   Moments for the Marginal Model:\n\n\\begin{align*}\n\\mathbb{E}[\\mathbf{Y}_{i} | \\boldsymbol{\\Omega}] &= \\alpha \\mathbf{1}_{n_i} + \\mathbf{X}_i\\boldsymbol{\\beta}\\\\\n\\mathbb{V}(\\mathbf{Y}_{i} | \\boldsymbol{\\Omega}) &= \\tau^2 \\mathbf{1}_{n_i} \\mathbf{1}_{n_i}^\\top + \\sigma^2 \\mathbf{I}_{n_i} = \\boldsymbol{\\Upsilon}_i\\\\\n\\mathbb{C}(\\mathbf{Y}_{i}, \\mathbf{Y}_{i'} | \\boldsymbol{\\Omega}) &= \\mathbf{0}_{n_i \\times n_i},\\quad i \\neq i'.\n\\end{align*}\n\n$$\\implies \\boldsymbol{\\Upsilon}_i = \\mathbb{V}(\\mathbf{Y}_{i} | \\boldsymbol{\\Omega}) = \\begin{bmatrix}\n    \\tau^2 + \\sigma^2 & \\tau^2 & \\cdots & \\tau^2\\\\\n    \\tau^2 & \\tau^2 + \\sigma^2 & \\cdots & \\tau^2\\\\\n    \\vdots & \\vdots & \\ddots & \\vdots\\\\\n    \\tau^2 & \\tau^2 & \\cdots &\\tau^2 + \\sigma^2\n  \\end{bmatrix}.$$\n\n<!-- ## Understanding the Correlation Structure {.midi} -->\n\n<!-- - The random intercept $\\theta_i$ introduces correlation between observations within the same group. -->\n\n<!-- - For two observations $Y_{ij}$ and $Y_{ik}$ from the same group $i$, we have: -->\n\n<!-- $$\\mathbb{C}(Y_{ij}, Y_{ik} | \\boldsymbol{\\Omega}) = \\tau^2.$$ -->\n\n<!-- - This non-zero covariance reflects the correlation between observations in the same group. -->\n\n<!-- - Note: $\\mathbb{C}(Y_{ij}, Y_{i'k} | \\boldsymbol{\\Omega}) = 0$ for $i \\neq i'$. -->\n\n<!-- ## Why Normal Distribution? -->\n\n<!-- - **Natural Assumption**: We assume that the hospital-specific parameters (e.g., hospital intercepts) are normally distributed with a mean of zero because there's no reason to expect systematic deviations from the population average. -->\n\n<!-- - **Flexibility**: The normal distribution allows us to model a wide range of variation in hospital effects, with the variance $\\tau^2$ capturing how much hospitals differ from each other. -->\n\n## Covariance Structure\n\n-   The variance $\\tau^2$ for $\\theta_i$ can be interpreted as the **covariance** between two observations from the same hospital.\n\n-   This reflects how much two observations from the same group are expected to be similar in terms of their outcomes.\n\n\\begin{align*}\n\\mathbb{C}(Y_{ij}, Y_{ik} | \\boldsymbol{\\Omega}) &= \\mathbb{V}(\\theta_i)\\\\\n&= \\tau^2.\n\\end{align*}\n\n-   Thus, $\\tau^2$ dictates the **within-group correlation** in our model.\n\n-   Note: $\\mathbb{C}(Y_{ij}, Y_{i'k} | \\boldsymbol{\\Omega}) = 0$ for $i \\neq i'$.\n\n## Induced Within Correlation\n\n\\begin{align*}\n\\rho (Y_{ij}, Y_{ik} | \\boldsymbol{\\Omega}) &= \\frac{\\mathbb{C}(Y_{ij}, Y_{ik} | \\boldsymbol{\\Omega})}{\\sqrt{\\mathbb{V}(Y_{ij} |  \\boldsymbol{\\Omega}) \\mathbb{V}(Y_{ik} |  \\boldsymbol{\\Omega})}}\\\\\n&=\\frac{\\tau^2}{\\tau^2 + \\sigma^2}\\\\\n&= \\frac{1}{1 + \\frac{\\sigma^2}{\\tau^2}}.\n\\end{align*}\n\nThis model induces positive correlation within group observations.\n\n## Induced Within Correlation\n\n$$\\rho (Y_{ij}, Y_{ik} | \\alpha,\\boldsymbol{\\beta},\\sigma) = \\frac{1}{1 + \\frac{\\sigma^2}{\\tau^2}}$$\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-hierarchical_files/figure-revealjs/unnamed-chunk-2-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Group-Specific Intercept Model: Marginal Specification\n\nFor $i = 1,\\ldots,n$, \\begin{align*}\n\\mathbf{Y}_{i} | \\boldsymbol{\\Omega} &\\stackrel{ind}{\\sim} N(\\alpha \\mathbf{1}_{n_i}+ \\mathbf{X}_i\\boldsymbol{\\beta},\\boldsymbol{\\Upsilon}_i)\\\\\n\\boldsymbol{\\Omega} &\\sim f(\\boldsymbol{\\Omega}),\n\\end{align*} where $\\boldsymbol{\\Omega} = (\\alpha, \\boldsymbol{\\beta},\\sigma,\\tau)$ are the population parameters.\n\n## Group-Specific Intercept Model: Marginal Specification\n\n-   The posterior for the conditional model can be written as:\n\n\\begin{align*}\nf(\\boldsymbol{\\Omega} | \\mathbf{Y}) &\\propto f(\\mathbf{Y}, \\boldsymbol{\\Omega})\\\\\n&= f(\\mathbf{Y} | \\boldsymbol{\\Omega})f(\\boldsymbol{\\Omega})\\\\\n&=  \\prod_{i=1}^n f(\\mathbf{Y}_{i} | \\boldsymbol{\\Omega}) f(\\boldsymbol{\\Omega}).\n\\end{align*}\n\n**Why might we be interested in fitting the marginal model?**\n\n## Recovering the Group-Specific Parameters {.midi}\n\n-   We can still recover the $\\theta_i$ when we fit the marginal model, we only need to compute $f(\\theta_i | \\mathbf{Y}_i,\\boldsymbol{\\Omega})$ for all $i$.\n\n-   We can obtain this full conditional by specifying the joint distribution,\n\n$$f\\left(\\begin{bmatrix}\n    \\mathbf{Y}_i\\\\\n    \\theta_i\n  \\end{bmatrix} \\Bigg| \\boldsymbol{\\Omega}\\right) = N\\left(\\begin{bmatrix}\n    \\alpha \\mathbf{1}_{n_i} + \\mathbf{X}_i \\boldsymbol{\\beta} + \\theta_i \\mathbf{1}_{n_i} + \\boldsymbol{\\epsilon}_i\\\\\n    0\n  \\end{bmatrix}, \\begin{bmatrix}\n    \\boldsymbol{\\Upsilon}_i & \\tau^2 \\mathbf{1}_{n_i}\\\\\n    \\tau^2 \\mathbf{1}_{n_i}^\\top & \\tau^2\n  \\end{bmatrix}\\right).$$\n\nWe can then use the [conditional specification of a multivariate normal](https://en.wikipedia.org/wiki/Multivariate_normal_distribution#Conditional_distributions) to find, $f(\\theta_i | \\mathbf{Y}_i, \\boldsymbol{\\Omega}) = N(\\mathbb{E}_{\\theta_i},\\mathbb{V}_{\\theta_i})$, where\n\n\\begin{align*}\n\\mathbb{E}_{\\theta_i} &= \\mathbf{0}_{n_i} + \\tau^2 \\mathbf{1}_{n_i}^\\top \\boldsymbol{\\Upsilon}_i^{-1} (\\mathbf{Y}_i - \\alpha \\mathbf{1}_{n_i} - \\mathbf{X}_i \\boldsymbol{\\beta})\\\\\n\\mathbb{V}_{\\theta_i} &= \\tau^2 - \\tau^4 \\mathbf{1}_{n_i}^\\top \\boldsymbol{\\Upsilon}_i^{-1} \\mathbf{1}_{n_i}.\n\\end{align*}\n\n<!-- ## Why Does This Model Work? -->\n\n<!-- 1. **Within-group correlation**: Observations within the same hospital are more similar due to the shared intercept. -->\n\n<!-- 2. **Between-group differences**: Groups have different intercepts $\\alpha_i^*$, reflecting different baseline effects. -->\n\n## Example data: Glucose Measurement in 4 Primary Care Clinics {.midi}\n\n-   We will study glucose values for patients being seen at 4 primary care clinics across the city. The clinics each represent a geographical region: east, west, north, and south.\n\n-   The dataset consists of glucose measurements (mg/dl) from patients, and also risk factors:\n\n    -   Age (years).\n\n    -   BMI ($kg/m^2$).\n\n    -   Sex (0 = male, 1 = female).\n\n    -   Smoking status (0 = non-smoker, 1 = smoker).\n\n    -   Physical activity level (0 = low, 1 = moderate, 2 = high).\n\n    -   Glucose lowering medication (0 = none, 1 = yes).\n\n## Preview the Data {.smallest}\n\n\n::: {.cell}\n\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-7499443be033e7ed8429\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-7499443be033e7ed8429\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\",\"24\",\"25\",\"26\",\"27\",\"28\",\"29\",\"30\",\"31\",\"32\",\"33\",\"34\",\"35\",\"36\",\"37\",\"38\",\"39\",\"40\",\"41\",\"42\",\"43\",\"44\",\"45\",\"46\",\"47\",\"48\",\"49\",\"50\",\"51\",\"52\",\"53\",\"54\",\"55\",\"56\",\"57\",\"58\",\"59\",\"60\",\"61\",\"62\",\"63\",\"64\",\"65\",\"66\",\"67\",\"68\",\"69\",\"70\",\"71\",\"72\",\"73\",\"74\",\"75\",\"76\",\"77\",\"78\",\"79\",\"80\",\"81\",\"82\",\"83\",\"84\",\"85\",\"86\",\"87\",\"88\",\"89\",\"90\",\"91\",\"92\",\"93\",\"94\",\"95\",\"96\",\"97\",\"98\",\"99\",\"100\",\"101\",\"102\",\"103\",\"104\",\"105\",\"106\",\"107\",\"108\",\"109\",\"110\",\"111\",\"112\",\"113\",\"114\",\"115\",\"116\",\"117\",\"118\",\"119\",\"120\",\"121\",\"122\",\"123\",\"124\",\"125\",\"126\",\"127\",\"128\",\"129\",\"130\",\"131\",\"132\",\"133\",\"134\",\"135\",\"136\",\"137\",\"138\",\"139\",\"140\",\"141\",\"142\",\"143\",\"144\",\"145\",\"146\",\"147\",\"148\",\"149\",\"150\",\"151\",\"152\",\"153\",\"154\",\"155\",\"156\",\"157\",\"158\",\"159\",\"160\",\"161\",\"162\",\"163\",\"164\",\"165\",\"166\",\"167\",\"168\",\"169\",\"170\",\"171\",\"172\",\"173\",\"174\",\"175\",\"176\",\"177\",\"178\",\"179\",\"180\",\"181\",\"182\",\"183\",\"184\",\"185\",\"186\",\"187\",\"188\",\"189\",\"190\",\"191\",\"192\",\"193\",\"194\",\"195\",\"196\",\"197\",\"198\",\"199\",\"200\",\"201\",\"202\",\"203\",\"204\",\"205\",\"206\",\"207\",\"208\",\"209\",\"210\",\"211\",\"212\",\"213\",\"214\",\"215\",\"216\",\"217\",\"218\",\"219\",\"220\",\"221\",\"222\",\"223\",\"224\",\"225\",\"226\",\"227\",\"228\",\"229\",\"230\",\"231\",\"232\",\"233\",\"234\",\"235\",\"236\",\"237\",\"238\",\"239\",\"240\",\"241\",\"242\",\"243\",\"244\",\"245\",\"246\",\"247\",\"248\",\"249\",\"250\",\"251\",\"252\",\"253\",\"254\",\"255\",\"256\",\"257\",\"258\",\"259\",\"260\",\"261\",\"262\",\"263\",\"264\",\"265\",\"266\",\"267\",\"268\",\"269\",\"270\",\"271\",\"272\",\"273\",\"274\",\"275\",\"276\",\"277\",\"278\",\"279\",\"280\",\"281\",\"282\",\"283\",\"284\",\"285\",\"286\",\"287\",\"288\",\"289\",\"290\",\"291\",\"292\",\"293\",\"294\",\"295\",\"296\",\"297\",\"298\",\"299\",\"300\",\"301\",\"302\",\"303\",\"304\",\"305\",\"306\",\"307\",\"308\",\"309\",\"310\",\"311\",\"312\",\"313\",\"314\",\"315\",\"316\",\"317\",\"318\",\"319\",\"320\",\"321\",\"322\",\"323\",\"324\",\"325\",\"326\",\"327\",\"328\",\"329\",\"330\",\"331\",\"332\",\"333\",\"334\",\"335\",\"336\",\"337\",\"338\",\"339\",\"340\",\"341\",\"342\",\"343\",\"344\",\"345\",\"346\",\"347\",\"348\",\"349\",\"350\",\"351\",\"352\",\"353\",\"354\",\"355\",\"356\",\"357\",\"358\",\"359\",\"360\",\"361\",\"362\",\"363\",\"364\",\"365\",\"366\",\"367\",\"368\",\"369\",\"370\",\"371\",\"372\",\"373\",\"374\",\"375\",\"376\",\"377\",\"378\",\"379\",\"380\",\"381\",\"382\",\"383\",\"384\",\"385\",\"386\",\"387\",\"388\",\"389\",\"390\",\"391\",\"392\",\"393\",\"394\",\"395\",\"396\",\"397\",\"398\",\"399\",\"400\",\"401\",\"402\",\"403\",\"404\",\"405\",\"406\",\"407\",\"408\",\"409\",\"410\",\"411\",\"412\",\"413\",\"414\",\"415\",\"416\",\"417\",\"418\",\"419\",\"420\",\"421\",\"422\",\"423\",\"424\",\"425\",\"426\",\"427\",\"428\",\"429\",\"430\",\"431\",\"432\",\"433\",\"434\",\"435\",\"436\",\"437\",\"438\",\"439\",\"440\",\"441\",\"442\",\"443\",\"444\",\"445\",\"446\",\"447\",\"448\",\"449\",\"450\",\"451\",\"452\",\"453\",\"454\",\"455\",\"456\",\"457\",\"458\",\"459\",\"460\",\"461\",\"462\",\"463\",\"464\",\"465\",\"466\",\"467\",\"468\",\"469\",\"470\",\"471\",\"472\",\"473\",\"474\",\"475\",\"476\",\"477\",\"478\",\"479\",\"480\",\"481\",\"482\",\"483\",\"484\",\"485\",\"486\",\"487\",\"488\",\"489\",\"490\",\"491\",\"492\",\"493\",\"494\",\"495\",\"496\",\"497\",\"498\",\"499\",\"500\"],[130.1,108.6,136.6,128.6,112.3,112.8,122.1,130.9,111.8,108.8,131.2,104.3,151.8,120.2,140.1,109.4,107.3,129.4,120.7,112.5,120.9,134.7,114.7,101.2,152.7,116,99.59999999999999,139.1,104,143,136.5,136,125.1,112.6,125.7,112.2,118.3,128.3,137.7,122.5,102.5,126.6,133.6,122.7,118.9,143,139.7,127.8,127.4,118.5,116.9,120.4,131.1,144.6,111.1,110.8,142.2,137.6,136.1,111.3,111.2,110.6,124.8,101.6,117.6,140.9,133.9,132.8,126.8,137.9,155.3,141.8,97,120.8,122.1,131.8,123.4,105.4,144.9,111.4,128.8,147,130.9,110,114,111.5,93.5,129.7,113.4,137,107.2,122.1,159.5,142.7,110.4,136.6,94,132,97.5,140.8,116.7,137.2,135.1,140,142.6,110.2,111.1,121.4,108.7,147.3,148.7,132.4,126.2,125.5,137.3,133.8,111.2,117.6,109.4,121.6,115.8,135.5,150,119.3,135.9,146,122.8,120.9,145.9,105.1,122.6,129.5,117.9,113.5,130.8,104.9,99.40000000000001,117.7,102.5,127.6,124.2,99.7,104.1,124.9,115.6,89.09999999999999,97.2,97.09999999999999,105.9,90.09999999999999,149.1,78.5,108.4,89.90000000000001,136.6,139,128.4,110.2,99,116,105.1,121.4,120.4,123.9,103.1,108.3,135.7,114.5,134,117.4,101,98.90000000000001,116.5,115.4,119.5,116.8,123.3,96.5,129.3,100.5,119.6,120.8,121.1,108.8,90.90000000000001,103,93.7,114.5,92.3,119.3,109.1,84.40000000000001,139.7,121.2,122.1,132.5,124.8,96.2,104.7,101,113.4,107.1,112.1,103.3,111.2,118.7,120.7,104.4,110.6,109.2,101.1,111.1,109.5,128.4,120.6,122.2,140.1,137.2,111.7,115.2,114.7,108.8,107.5,95,146.9,114.2,117.2,95,138.6,98.2,131.2,120.1,104.4,129.7,87.40000000000001,122.5,115.3,117.1,88.09999999999999,96.7,115.4,129.5,116.8,96.8,117.2,109.5,98.2,112.8,106.9,110.8,113.7,103.4,114.5,114,102.8,113.7,120.9,110.4,119.5,127,123.2,100.8,109.9,122.2,126.7,120.7,130.5,105.3,112.2,113.9,109.6,108,151.8,131.4,101.5,126.3,134.3,108.4,138.3,131.6,136.7,122.8,118.2,102.7,127.2,108,121.8,105.9,112.2,131.9,91.8,99.7,119.2,124.4,149.4,134.4,133.4,106.1,145.7,114.1,103.9,100,102.9,129.7,138,108.1,134.2,124.4,110.3,113.6,127.1,131.7,117.9,115.1,115.7,121.7,104,114,122.2,133.1,122.1,107.2,123.9,114.9,130.5,94.3,112.6,150.7,114.7,112.1,106.6,120.8,115.1,127.9,123.3,134,123.2,148.8,138,135.5,118,128.3,120,151.4,113,125.7,110.7,129.5,135.4,114.7,102.3,127.6,133.9,91.7,119,130.8,138.3,124.5,135.4,134.1,103.3,140.7,120.8,139.5,110.3,117.2,121.9,120.6,105.7,97,143.9,96.3,140.1,92.59999999999999,123.4,131.2,148.6,120.8,122.8,121.1,110.7,124.1,117.3,135.3,134.9,117.2,100.1,135.1,139.8,122.7,99.90000000000001,117.5,158.8,133.4,137.8,137.3,108,122.8,119.1,139.4,138.3,99.3,105.5,121.8,119,110.8,151.6,131.3,129.2,117,135.5,124.5,124.6,136.2,127.1,108.9,138.3,145.7,151.3,118.8,100.2,135.9,117.2,155.8,113.7,116.5,144.4,126.9,124.7,132.2,133.4,115.7,133.9,117.3,136.2,149.2,118.4,122.1,131,134.4,118.9,113.4,125.3,117.5,120.6,116,133.8,127.9,145.8,121.4,121.9,132.9,153.7,125,136.6,150.5,118.8,113.3,138.1,130.4,112.3,128.2,120.1,122.2,119.6,137.8,113.5,131.2,97.5,127.3,143.4,117.1,114.4,129.2,125,144.3,115.7,109.2,139.2,128,113.5,114.9,139.1,121.1,146.1,141.7,96.90000000000001,122.8,115.8,118.6,114.4,112.2,139.7,113.6,136.5,136.9,121.6,110,129,122.6],[72,61,50,56,39,55,51,56,59,61,64,55,64,59,66,58,61,58,44,33,79,66,55,36,50,43,43,57,57,75,70,50,68,51,54,40,62,50,70,56,45,67,48,63,52,63,59,53,50,43,61,48,54,73,52,59,39,52,67,54,61,75,61,80,49,71,71,48,58,50,61,55,55,64,56,58,48,52,60,51,61,54,58,29,64,59,47,72,44,49,51,45,62,37,42,69,36,46,61,48,51,71,63,43,37,55,72,50,46,63,55,55,48,48,51,58,72,52,45,62,40,58,65,38,64,62,45,43,37,71,56,55,67,62,67,45,59,50,69,40,69,62,65,46,54,54,29,50,39,64,79,41,55,51,63,51,56,58,61,48,59,61,51,51,58,40,67,58,68,60,54,54,48,48,50,54,68,51,57,56,31,51,66,65,44,51,47,53,67,46,55,57,45,52,51,43,76,45,31,63,45,60,58,59,63,52,71,39,52,51,62,47,55,62,52,38,66,51,45,48,58,48,69,63,59,48,52,54,60,57,72,53,59,48,61,75,40,73,51,54,61,41,52,45,49,36,58,41,58,66,62,69,56,64,64,68,40,72,53,45,64,46,52,66,57,74,54,42,45,44,48,46,58,54,32,47,45,48,64,61,49,33,57,52,43,62,59,63,41,54,47,64,68,54,72,70,50,43,55,79,43,59,71,60,82,41,57,55,52,50,34,66,53,52,43,45,62,40,63,46,54,43,42,61,51,61,54,66,66,54,55,47,54,72,43,42,54,67,67,60,71,63,54,66,51,80,34,39,39,40,84,48,44,35,44,58,66,39,60,58,58,54,47,52,30,58,65,64,49,56,50,64,61,52,54,52,56,48,53,60,48,56,68,67,60,44,59,55,41,57,58,50,70,56,76,79,58,43,58,54,72,49,42,42,61,72,65,57,55,45,53,53,43,49,67,52,54,54,55,53,60,56,51,75,28,57,72,49,56,78,55,42,58,65,57,74,43,54,54,23,75,55,44,59,74,53,55,67,51,61,56,67,62,46,48,72,56,48,53,48,43,47,52,67,45,46,60,39,37,45,57,49,68,40,69,77,53,66,67,47,70,38,63,40,77,56,48,59,40,59,59,56,64,58,62,54,58,50,55,59],[34.2,29.8,28.8,32.6,29.6,30.2,30.2,33.9,28.8,30.3,34.6,27.3,30.2,33.2,31.2,37.7,35,24.1,32,27.7,27.3,37.1,27.7,37.8,31.3,25,35.2,36.8,18.7,30,28.8,32.9,29.4,32.5,27,30.2,28.1,29.5,30.3,25.2,30.9,26.1,28.6,28.6,25.2,27.8,31.5,25.7,11.4,23.8,27.2,25.4,31.4,40.5,30.2,30.6,41.7,36.9,33.8,25.7,27.7,32.7,21.3,24,31.8,26.1,27.3,26.1,32.6,36.3,29.9,23.9,36.1,25.6,29,33.3,37.5,37.8,32.5,27.9,32.3,36.1,28,27.8,31.9,26.7,33.3,32.6,33.1,46.4,31.5,34.9,27.7,27.6,33.7,27.5,26.6,37.9,27.9,30.4,31.8,31.6,21.1,35.9,32.5,28,26,45.4,33.4,32.2,30,26.5,30.4,35,24.1,31.4,25.6,32.7,26.8,24.5,25.4,29.9,39.2,36.6,25.2,21.3,26.6,33.8,25.3,31.6,30.2,35.7,19.7,32,35.1,31.1,32.3,30.3,28.6,30.7,28.6,25.7,38.4,36.6,34.4,28.6,24.5,42.8,23.3,27.1,23.7,28,27,33.9,30.7,33.5,31.5,30.5,23.7,35.4,32.8,31.6,29.9,27.7,19.3,31.4,26.2,33.9,33.7,26.5,31.8,27.3,39.8,29.1,29.9,36.8,33.6,27.5,28.1,44.9,25.6,29.9,35.1,28.8,23.4,24.2,25.2,29.5,30.6,30.2,34.4,29.8,35.4,35.9,25.8,27.7,28.5,32.2,31.3,27.2,27.4,21.7,30,25.9,25.1,21.6,31.8,32,29.1,31.5,30.6,32.2,30.8,23.9,32.9,23.9,37.2,33.2,27.7,28.1,24,27.2,33.1,21.3,36.4,18.6,32.9,34.7,29.9,28.1,30.8,19.9,32.1,32.9,28.2,33.1,31.2,34.2,30.5,32.7,27.2,23.6,27.1,31.9,32.3,30.8,43.6,30.7,29.7,30.4,23,25.4,30.5,26.2,34.8,28.6,35.5,21.5,38.3,29.5,31.6,24.3,26.2,25.6,37.4,34,35.1,35.5,34,32,30.7,28.1,38.9,33.1,18.8,24.8,27.1,28.3,23.4,33,32.8,34.6,23.1,24.2,27.7,33.7,29.4,36.6,32.6,36.2,34.8,21.6,32.9,28.8,29.4,37.8,34.9,32.3,39.1,37.8,30.9,20.9,34.7,24.9,25.9,30.5,31.6,30.9,21.8,30.4,36.1,37.3,35.3,26.5,36.3,34.5,32.5,29.1,27.2,31.7,22.2,33,34,35.4,25.7,27.1,32.2,32.5,28.8,27.9,31.8,31.5,29,28,33.5,25.4,28.4,29.2,33.4,33.1,37.3,31.9,25.2,27.1,31.6,32.1,38.2,26.3,35.1,25.6,22.4,32.5,29,24.7,34.7,28.1,31.3,21.3,24.7,30.1,23,35.1,17,30,34.1,36.7,27.8,28.6,29.3,23.4,33,38.8,28.7,28,35.4,31,19.6,23.3,27,33.7,25.6,22.7,35.1,29.9,31.5,29,19.2,37.6,30.5,25.5,30.4,25.5,35.5,31.7,23.6,28.4,28.2,28.9,29.7,27,32.2,41.9,25.5,26.2,29.8,30.3,37.1,31.3,28.3,33,42.7,37.6,29.9,35.2,31.9,32.2,27.2,31.2,30.7,23.3,25.4,31.4,34,30.6,27.2,28.7,33.1,18.9,35.7,28.7,36.6,28.5,30.2,26.7,29.5,30.3,30.5,30.8,33.1,40.9,19.7,27.8,25.5,30.6,23.5,23.4,43.6,27.1,23.1,30,32,32.7,35,32.3,32.3,37.7,31.9,37.3,32.8,25.1,30.9,35.9,26.6,25.5,35.5,30,32.6,28.7,25,21.6,37.7,32.5,18.5,30.7,34.5,34.3,27.5,26.4,26.3,40.4,31.9,31.7,29.8,30.3,33.9,28.7,26.8,26.8,30.3,32.8,28.8,30.5,26.7,22.9,32.1,35,18.6,29.6,31.8,21.9],[0,0,0,1,1,0,1,0,0,1,1,0,1,0,0,1,0,1,0,0,1,1,0,0,1,0,0,0,1,1,1,0,1,1,0,1,0,1,0,0,1,0,1,1,1,1,0,1,1,0,1,0,0,1,0,0,0,1,0,1,0,0,1,0,0,1,0,0,1,1,1,1,0,0,0,1,1,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,1,1,0,0,1,0,1,1,1,1,0,1,1,0,1,1,0,0,1,1,1,0,1,1,0,0,1,0,1,1,0,0,1,0,0,0,0,1,1,0,0,0,1,0,1,0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,0,1,0,0,1,0,1,1,0,0,1,0,0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1,0,1,0,1,1,0,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,1,1,0,1,1,0,1,1,0,0,0,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,1,0,1,1,0,0,1,1,1,0,0,0,1,1,1,1,1,1,0,1,0,0,1,1,1,1,1,1,1,0,1,0,1,0,1,1,0,0,0,1,0,0,1,0,1,1,0,1,0,0,0,0,0,1,0,0,1,1,1,0,1,1,1,1,0,0,0,1,0,1,0,0,0,0,0,0,1,1,0,1,1,0,0,0,1,1,0,1,0,1,0,0,0,1,0,0,1,1,1,1,0,1,1,0,1,1,0,1,1,1,0,0,1,1,1,0,1,0,1,0,1,0,1,0,0,1,1,0,0,1,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,0,1,1,0,0,0,1,1,0,1,0,0,1,0,0,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,1,1,1,0,0,1,1,0,1,1,1,0,0,1,0,0,0,0,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,0,0,1,0,0,0,1,1,1,1,1,0,0,1,0,0,1,1,0,0,1,0,1,0,0,1,1,0,1,0,1,0,0,1,0,0,1,1],[1,0,0,0,0,0,1,0,1,1,1,0,0,0,0,1,1,0,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,1,1,1,0,1,0,0,0,0,1,0,0,1,0,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,0,1,0,0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1,1,1,1,0,0,0,1,0,1,1,1,1,1,1,0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,1,1,1,0,0,0,1,1,0,1,1,0,1,0,0,0,0,1,0,0,1,1,0,1,1,1,1,1,0,1,0,1,1,0,1,1,0,1,1,0,1,0,1,1,1,0,1,1,0,0,0,1,0,0,0,1,1,0,0,0,1,1,1,0,0,1,0,1,1,1,1,1,1,0,1,1,1,1,0,1,0,0,1,0,0,1,0,1,1,1,1,1,1,0,1,1,1,0,0,0,0,0,0,1,0,1,1,1,0,1,0,1,1,1,0,1,1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,1,0,0,1,1,1,1,1,0,0,0,0,0,0,1,1,0,0,1,0,0,0,1,1,0,0,1,1,1,0,1,1,1,1,1,0,0,0,0,0,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,0,1,1,0,0,1,0,1,1,1,0,0,0,0,0,0,1,1,0,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,1,1,0,0,1,0,0,1,0,1,1,1,1,0,1,1,0,1,0,0,0,0,1,0,0,1,0,1,1,0,1,0,1,0,1,1,1,0,0,0,0,0,0,1,1,0,1,1,0,0,1,0,1,0,0,1,1,1,0,1,0,0,1,1,0,1,0,0,1,1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,1,1,0,1,0,1,0,1,1,1,1,1,0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0,0,0,1,0,1,0,1,1,1,1,1,0,0,1,0,1,1,0,0,1],[0,0,1,2,2,0,0,1,1,2,1,1,1,0,2,2,1,1,2,0,0,0,1,0,1,2,0,1,1,1,2,0,0,2,0,1,2,0,0,1,2,1,0,1,0,1,0,0,0,2,1,1,2,1,1,0,1,2,1,0,0,1,2,2,0,0,2,1,2,1,1,1,2,0,2,0,2,1,2,1,2,1,1,1,2,1,0,2,0,2,0,0,1,1,1,2,1,1,0,0,2,2,2,1,0,0,2,2,0,1,2,2,2,1,2,0,1,1,0,1,1,0,1,1,2,0,2,2,2,2,1,0,2,1,0,0,0,0,0,0,2,0,2,1,1,2,2,2,2,0,1,1,0,2,2,2,0,2,2,0,0,0,0,1,1,0,0,2,1,1,0,0,2,2,0,2,2,2,0,0,1,1,1,1,1,2,0,1,2,0,2,2,0,2,2,0,1,2,1,0,2,0,0,0,2,0,2,0,2,0,1,2,1,0,2,1,0,0,0,2,0,2,0,1,1,2,2,0,1,1,0,0,1,0,0,2,2,1,0,2,0,1,2,1,2,1,2,2,1,2,0,0,0,0,2,1,1,1,2,0,0,1,0,1,0,2,0,2,2,0,1,2,0,2,2,1,2,0,2,1,1,1,0,2,2,0,2,1,1,0,2,0,0,2,0,2,1,2,0,2,1,0,1,0,1,0,2,2,0,2,0,1,1,0,1,2,0,0,1,0,1,2,1,0,1,2,0,0,1,0,0,1,1,1,1,1,1,0,0,0,2,0,2,1,1,2,0,0,1,1,2,2,1,2,0,1,2,1,1,2,0,0,0,2,2,0,2,0,2,2,0,2,0,2,1,2,0,0,1,1,0,0,2,2,0,1,0,1,1,0,2,0,0,2,0,0,2,1,2,1,0,2,2,1,1,1,0,0,0,1,1,1,2,1,0,1,1,2,2,2,2,0,0,0,1,0,1,0,0,1,1,2,0,0,2,0,2,1,0,1,0,2,1,1,1,1,1,1,1,0,2,1,1,0,1,1,2,1,2,1,1,1,0,1,0,0,1,0,2,2,2,2,0,2,2,2,0,1,1,2,1,0,2,2,1,1,1,2,0,1,2,0,1,1,0,0,0,0,2,0],[0,1,0,1,1,1,1,0,1,1,0,1,0,1,0,1,1,1,0,0,1,1,1,1,0,0,1,0,1,0,0,0,1,1,0,1,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,1,1,0,0,0,1,1,1,0,1,1,0,0,0,0,0,0,0,1,0,0,0,1,1,0,1,1,0,0,0,1,1,1,0,1,0,1,1,0,0,1,0,1,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,1,1,1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,1,0,1,0,0,1,1,0,1,1,1,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,0,1,0,1,0,0,0,1,1,1,1,0,1,0,0,1,0,0,0,0,0,1,1,1,0,1,1,0,0,0,0,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,1,1,0,0,0,1,0,1,0,1,1,0,1,0,0,0,1,1,0,0,0,1,0,0,1,0,1,0,0,0,1,1,1,1,1,1,1,0,0,1,1,0,1,0,1,1,0,1,1,0,0,0,1,0,0,1,0,0,0,0,1,1,0,1,0,1,1,0,1,1,1,0,0,0,0,1,0,1,1,1,1,0,0,1,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,1,0,1,1,0,1,1,1,0,1,0,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,1,1,0,0,1,1,0,0,0,0,0,1,0,1,0,1,1,1,1,1,1,0,1,0,1,1,0,0,0,0,1,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,1,1,0,1,1,1,1,1,0,0,0,1,0,1,0,0,0,1,0,1,0,0,1,1,1,0,1,1,0,0,1,1,0,1,0,1,0,0,0,0,0,0,0,1,1,1,0,1,0,1,0,1,1,0,0,1,0,0,1,1,0,0,1,1,0,0,1,0,1,0,1,0,0,1,1,0,1,0,1,1,0,1,1,0,0,0,0,0,1,0,1,0,0,1,1,1,0,1,0,1,1,1],[\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"East\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"North\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"South\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\",\"West\"]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>glucose<\\/th>\\n      <th>age<\\/th>\\n      <th>bmi<\\/th>\\n      <th>gender<\\/th>\\n      <th>smoking<\\/th>\\n      <th>activity<\\/th>\\n      <th>medication<\\/th>\\n      <th>region<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4,5,6,7]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"glucose\",\"targets\":1},{\"name\":\"age\",\"targets\":2},{\"name\":\"bmi\",\"targets\":3},{\"name\":\"gender\",\"targets\":4},{\"name\":\"smoking\",\"targets\":5},{\"name\":\"activity\",\"targets\":6},{\"name\":\"medication\",\"targets\":7},{\"name\":\"region\",\"targets\":8}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n## Writing down a model\n\nWe would like to fit the following model:\n\n$$Y_{ij} = \\alpha + \\mathbf{x}_{ij} \\boldsymbol{\\beta} + \\theta_i + \\epsilon_{ij},\\quad \\epsilon_{ij} \\stackrel{iid}{\\sim}N(0,\\sigma^2).$$\n\n-   $Y_{ij}$ is the glucose value for patient $i$ in clinic $j$\n\n-   $\\theta_i$ for $i = 1,\\ldots,4$ is the clinic-specific intercept deviation. \\begin{align*}\n    \\mathbf{x}_{ij} &= (Age_{ij}, BMI_{ij}, Female_{ij},Smoker_{ij}, \\\\\n    &\\quad Moderate\\_Activity_{ij}, High\\_Activity_{ij}, On\\_Meds_{ij}).\n    \\end{align*}\n\n## Fitting the Conditional Model in Stan\n\n\n::: {.cell output.var='conditional'}\n\n```{.stan .cell-code}\n// conditional-model.stan\ndata {\n  int<lower = 1> n;\n  int<lower = 1> N;\n  int<lower = 1> p;\n  matrix[N, p] X;\n  vector[N] Y;\n  int<lower = 1, upper = n> Ids[N];\n}\nparameters {\n  real alpha;\n  vector[p] beta;\n  real<lower = 0> sigma;\n  real<lower = 0> tau;\n  vector[n] theta;\n}\nmodel {\n  vector[N] mu = rep_vector(0.0, N);\n  mu += alpha;\n  for (i in 1:N) {\n    mu[i] += X[i, ] * beta + theta[Ids[i]];\n  }\n  target += normal_lpdf(Y | mu, sigma);\n  target += normal_lpdf(theta | 0, tau);\n  target += normal_lpdf(alpha | 0, 3);\n  target += normal_lpdf(beta | 0, 3);\n  target += normal_lpdf(sigma | 0, 3);\n  target += normal_lpdf(tau | 0, 3);\n}\ngenerated quantities {\n  real Intercept_East = alpha + theta[1];\n  real Intercept_North = alpha + theta[2];\n  real Intercept_South = alpha + theta[3];\n  real Intercept_West = alpha + theta[4];\n  real rho = 1 / (1 + ((sigma * sigma) / (tau * tau)));\n  vector[N] Y_pred;\n  vector[N] log_lik;\n  vector[N] mu = rep_vector(0.0, N);\n  mu += alpha;\n  for (i in 1:N) {\n    mu[i] += X[i, ] * beta + theta[Ids[i]];\n    log_lik[i] = normal_lpdf(Y[i] | mu[i], sigma);\n    Y_pred[i] = normal_rng(mu[i], sigma);\n  }\n}\n```\n:::\n\n\n## Fitting the Model in Stan\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- model.matrix(~ age + bmi + gender + smoking + as.factor(activity) + medication, data = data)[, -1]\nstan_data <- list(\n  N = nrow(data),\n  n = length(unique(data$region)),\n  p = ncol(X),\n  X = X,\n  Y = data$glucose,\n  Ids = as.numeric(as.factor(data$region))\n)\nconditional_model <- stan_model(model_code = \"conditional-model.stan\")\nfit_conditional <- sampling(conditional_model, stan_data)\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n## Assessing Convergence\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntraceplot(fit_conditional, pars = c(\"alpha\", \"beta\", \"sigma\", \"tau\", \"rho\"))\n```\n\n::: {.cell-output-display}\n![](14-hierarchical_files/figure-revealjs/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n\n## Assessing Convergence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(bayesplot)\nbayesplot::mcmc_acf(fit_conditional, regex_pars = c(\"alpha\", \"beta\", \"sigma\", \"tau\", \"rho\"))\n```\n\n::: {.cell-output-display}\n![](14-hierarchical_files/figure-revealjs/unnamed-chunk-9-1.png){width=960}\n:::\n:::\n\n\n## Posterior Summaries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(fit_conditional, pars = c(\"alpha\", \"beta\", \"sigma\", \"tau\", \"rho\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInference for Stan model: anon_model.\n4 chains, each with iter=2000; warmup=1000; thin=1; \npost-warmup draws per chain=1000, total post-warmup draws=4000.\n\n          mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat\nalpha    99.03    0.10 3.77  91.46  96.59  99.06 101.61 106.29  1533    1\nbeta[1]   0.26    0.00 0.03   0.20   0.23   0.26   0.28   0.32  4245    1\nbeta[2]   0.48    0.00 0.07   0.35   0.44   0.48   0.53   0.62  4989    1\nbeta[3]  10.50    0.01 0.65   9.18  10.06  10.51  10.93  11.75  5966    1\nbeta[4]  -4.75    0.01 0.66  -6.03  -5.20  -4.76  -4.30  -3.46  7324    1\nbeta[5]   0.28    0.01 0.78  -1.21  -0.26   0.29   0.80   1.82  4746    1\nbeta[6]  -4.53    0.01 0.77  -6.03  -5.06  -4.53  -4.00  -3.02  4869    1\nbeta[7] -17.89    0.01 0.64 -19.15 -18.31 -17.89 -17.47 -16.64  5387    1\nsigma     7.43    0.00 0.23   6.99   7.28   7.43   7.59   7.90  5900    1\ntau       4.58    0.02 1.33   2.59   3.60   4.35   5.34   7.65  2941    1\nrho       0.27    0.00 0.11   0.11   0.19   0.26   0.34   0.51  3136    1\n\nSamples were drawn using NUTS(diag_e) at Wed Feb 26 10:48:54 2025.\nFor each parameter, n_eff is a crude measure of effective sample size,\nand Rhat is the potential scale reduction factor on split chains (at \nconvergence, Rhat=1).\n```\n\n\n:::\n:::\n\n\n## Comparison to Linear Regression: $\\boldsymbol{\\beta}$\n\n\n::: {.cell layout-ncol=\"2\" layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-hierarchical_files/figure-revealjs/unnamed-chunk-11-1.png){fig-align='center' width=480}\n:::\n\n::: {.cell-output-display}\n![](14-hierarchical_files/figure-revealjs/unnamed-chunk-11-2.png){fig-align='center' width=480}\n:::\n:::\n\n\n## Model Comparison\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(loo)\nwaic_conditional <- waic(extract_log_lik(fit_conditional))\nwaic_lin_reg <- waic(extract_log_lik(fit_lin_reg))\ncomparison <- loo_compare(list(\"Hierarchical Model\" = waic_conditional, \"Linear Regression\" = waic_lin_reg))\nprint(comparison, simplify = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   elpd_diff se_diff elpd_waic se_elpd_waic p_waic  se_p_waic\nHierarchical Model     0.0       0.0 -1720.6      15.2         11.5     0.7  \nLinear Regression    -71.6      10.7 -1792.2      15.6          8.6     0.6  \n                   waic    se_waic\nHierarchical Model  3441.2    30.4\nLinear Regression   3584.3    31.1\n```\n\n\n:::\n:::\n\n\n## Explore the Clinic-Specific Variation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(fit_conditional, pars = c(\"Intercept_East\", \"Intercept_South\", \"Intercept_North\", \"Intercept_West\"), probs = c(0.025, 0.975))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInference for Stan model: anon_model.\n4 chains, each with iter=2000; warmup=1000; thin=1; \npost-warmup draws per chain=1000, total post-warmup draws=4000.\n\n                  mean se_mean   sd  2.5%  97.5% n_eff Rhat\nIntercept_East  102.08    0.05 2.88 96.55 107.62  3461    1\nIntercept_South  98.46    0.05 2.88 92.89 103.99  3498    1\nIntercept_North  92.35    0.05 2.87 86.78  97.90  3398    1\nIntercept_West  103.55    0.05 2.90 97.85 109.10  3502    1\n\nSamples were drawn using NUTS(diag_e) at Wed Feb 26 10:48:54 2025.\nFor each parameter, n_eff is a crude measure of effective sample size,\nand Rhat is the potential scale reduction factor on split chains (at \nconvergence, Rhat=1).\n```\n\n\n:::\n:::\n\n\n## Explore the Clinic-Specific Variation\n\n\n::: {.cell layout-ncol=\"1\" layout-align=\"center\"}\n::: {.cell-output-display}\n![](14-hierarchical_files/figure-revealjs/unnamed-chunk-14-1.png){fig-align='center' width=768}\n:::\n:::\n\n\n## Fitting the Marginal Model in Stan\n\nNeed [ragged data structure](https://mc-stan.org/docs/stan-users-guide/sparse-ragged.html#ragged-data-structs.section).\n\n\n::: {.cell output.var='marginal'}\n\n```{.stan .cell-code}\n// marginal-model.stan\ndata {\n  int<lower = 1> n;\n  int<lower = 1> N;\n  int<lower = 1> p;\n  matrix[N, p] X;\n  vector[N] Y;\n  int n_is[n];\n}\nparameters {\n  real alpha;\n  vector[p] beta;\n  real<lower = 0> sigma;\n  real<lower = 0> tau;\n}\ntransformed parameters {\n  real sigma2 = sigma * sigma;\n  real tau2 = tau * tau;\n}\nmodel {\n  // compute the mean process for the marginal model\n  vector[N] mu = rep_vector(0.0, N);\n  mu += alpha;\n  for (i in 1:N) {\n    mu[i] += X[i, ] * beta;\n  }\n  // evaluate the likelihood for the marginal model using ragged data structure\n  int pos;\n  pos = 1;\n  for (i in 1:n) {\n    int n_i = n_is[i];\n    matrix[n_i, n_i] Upsilon_i = sigma2 * diag_matrix(rep_vector(1.0, n_i)) + tau2 * rep_matrix(1, n_i, n_i);\n    vector[n_i] Y_i = segment(Y, pos, n_i);\n    vector[n_i] mu_i = segment(mu, pos, n_i);\n    target += multi_normal_lpdf(Y_i | mu_i, Upsilon_i);\n    pos = pos + n_i;\n  }\n  // priors\n  target += normal_lpdf(alpha | 0, 3);\n  target += normal_lpdf(beta | 0, 3);\n  target += normal_lpdf(sigma | 0, 3);\n  target += normal_lpdf(tau | 0, 3);\n}\ngenerated quantities {\n  // compute the mean process for the marginal model\n  vector[N] mu = rep_vector(0.0, N);\n  mu += alpha;\n  for (i in 1:N) {\n    mu[i] += X[i, ] * beta;\n  }\n  // compute theta using the ragged data structure\n  int pos;\n  pos = 1;\n  vector[n] theta;\n  for (i in 1:n) {\n    int n_i = n_is[i];\n    vector[n_i] ones_i = rep_vector(1.0, n_i);\n    matrix[n_i, n_i] Upsilon_i = sigma2 * diag_matrix(ones_i) + tau2 * rep_matrix(1, n_i, n_i);\n    vector[n_i] Y_i = segment(Y, pos, n_i);\n    vector[n_i] mu_i = segment(mu, pos, n_i);\n    real mean_theta_i = tau2 * ones_i' * inverse_spd(Upsilon_i) * (Y_i - mu_i);\n    real var_theta_i = tau2 - tau2 * tau2 * ones_i' * inverse_spd(Upsilon_i) * ones_i;\n    theta[i] = normal_rng(mean_theta_i, sqrt(var_theta_i));\n    pos = pos + n_i;\n  }\n}\n```\n:::\n\n\n## Fitting the Model in Stan\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstan_data <- list(\n  N = nrow(data),\n  n = length(unique(data$region)),\n  p = ncol(X),\n  X = X,\n  Y = data$glucose,\n  n_is = as.numeric(table(data$region))\n)\nmarginal_model <- stan_model(model_code = \"marginal-model.stan\")\nfit_marginal <- sampling(marginal_model, stan_data)\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n## Assessing Convergence\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntraceplot(fit_marginal, pars = c(\"alpha\", \"beta\", \"sigma\", \"tau\"))\n```\n\n::: {.cell-output-display}\n![](14-hierarchical_files/figure-revealjs/unnamed-chunk-18-1.png){width=960}\n:::\n:::\n\n\n## Assessing Convergence\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(bayesplot)\nbayesplot::mcmc_acf(fit_marginal, regex_pars = c(\"alpha\", \"beta\", \"sigma\", \"tau\"))\n```\n\n::: {.cell-output-display}\n![](14-hierarchical_files/figure-revealjs/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n## Posterior Summaries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(fit_marginal, pars = c(\"alpha\", \"beta\", \"sigma\", \"tau\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nInference for Stan model: anon_model.\n4 chains, each with iter=2000; warmup=1000; thin=1; \npost-warmup draws per chain=1000, total post-warmup draws=4000.\n\n          mean se_mean   sd   2.5%    25%    50%    75%  97.5% n_eff Rhat\nalpha    99.07    0.06 3.66  91.97  96.66  99.05 101.50 106.36  3285    1\nbeta[1]   0.26    0.00 0.03   0.20   0.24   0.26   0.28   0.32  3957    1\nbeta[2]   0.48    0.00 0.07   0.35   0.44   0.48   0.53   0.61  3389    1\nbeta[3]  10.48    0.01 0.67   9.18  10.01  10.49  10.95  11.76  4532    1\nbeta[4]  -4.75    0.01 0.65  -6.01  -5.18  -4.75  -4.34  -3.45  4611    1\nbeta[5]   0.29    0.01 0.77  -1.26  -0.23   0.28   0.79   1.77  3834    1\nbeta[6]  -4.51    0.01 0.79  -6.04  -5.04  -4.50  -4.00  -3.01  3855    1\nbeta[7] -17.88    0.01 0.66 -19.14 -18.33 -17.88 -17.44 -16.56  4370    1\nsigma     7.43    0.00 0.24   6.99   7.27   7.43   7.60   7.92  4223    1\ntau       4.55    0.02 1.27   2.61   3.62   4.38   5.27   7.48  3714    1\n\nSamples were drawn using NUTS(diag_e) at Wed Feb 26 11:25:39 2025.\nFor each parameter, n_eff is a crude measure of effective sample size,\nand Rhat is the potential scale reduction factor on split chains (at \nconvergence, Rhat=1).\n```\n\n\n:::\n:::\n\n\n## Conclusion\n\n-   By introducing a group-specific intercept, we allow for dependencies between observations within groups, making the model more realistic for real-world clustered or repeated measures data.\n\n-   For the remainder of the class, we will expand upon this hierarchical modeling framework to account for complext data types that are frequently encountered in research, including longitudinal and spatial data.\n\n## Prepare for next class\n\n-   Complete [HW 03](https://biostat725-sp26.netlify.app/hw/hw-03), which is due before Thursday's class.\n\n-   Next Thursday's lecture: Longitudinal Data\n\n-   Exam 1 will be assigned after class on Thursday!",
    "supporting": [
      "14-hierarchical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/datatables-binding-0.33/datatables.js\"></script>\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}